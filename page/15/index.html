<!DOCTYPE html><html class="theme-next pisces use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/logo.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?v=5.1.4"><link rel="mask-icon" href="/logo.png?v=5.1.4" color="#222"><meta name="keywords" content="Google SEO, 互联网营销, 工业品营销, 矿山机械"><link rel="alternate" href="/atom.xml" title="Ray's Blog" type="application/atom+xml"><meta name="description" content="Google SEO|互联网营销|工业品营销|矿山机械电子商务|B2B、SEM、社交、EDM邮件营销、市场营销"><meta property="og:type" content="website"><meta property="og:title" content="Ray&#39;s Blog"><meta property="og:url" content="https://www.love4026.org/page/15/index.html"><meta property="og:site_name" content="Ray&#39;s Blog"><meta property="og:description" content="Google SEO|互联网营销|工业品营销|矿山机械电子商务|B2B、SEM、社交、EDM邮件营销、市场营销"><meta property="og:locale" content="zh-Hans"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Ray&#39;s Blog"><meta name="twitter:description" content="Google SEO|互联网营销|工业品营销|矿山机械电子商务|B2B、SEM、社交、EDM邮件营销、市场营销"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Pisces",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://www.love4026.org/page/15/"><title>Google SEO|互联网营销|工业品营销|矿山机械电子商务|B2B、SEM、社交、EDM邮件营销、市场营销 - Ray's Blog</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-home"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Ray's Blog</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">Google SEO|互联网营销|工业矿山机械</h1></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-友情链接"><a href="/links/" rel="section"><i class="menu-item-icon fa fa-fw fa-link"></i><br> 友情链接</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><section id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.love4026.org/313619/lnmp502错误调整-pm-start_servers-or-pm-minmax_spare_servers/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Ray Chang"><meta itemprop="description" content="Think Difficulty"><meta itemprop="image" content="/logo.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Ray's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/313619/lnmp502错误调整-pm-start_servers-or-pm-minmax_spare_servers/" itemprop="url">lnmp502错误,调整 pm.start_servers, or pm.min/max_spare_servers</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2013-07-18T02:34:45+08:00">2013-07-18</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span></span> <span id="/313619/lnmp502错误调整-pm-start_servers-or-pm-minmax_spare_servers/" class="leancloud_visitors" data-flag-title="lnmp502错误,调整 pm.start_servers, or pm.min/max_spare_servers"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数&#58;</span><span class="leancloud-visitors-count"></span></span> <span class="post-meta-divider">|</span><span class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">63</span></span></div></header><div class="post-body" itemprop="articleBody"><p>[pool www] seems busy (you may need to increase pm.start_servers, or pm.min/max_spare_servers), spawning 8 children, there are 0 idle, and 12 total children</p><p>编辑以下内容,调大一下,start_servers和max_spare_servers 可以避免一定情况下的502频繁错误.</p><p>文件在/usr/local/php/etc/php-fpm.conf</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.love4026.org/313616/诺贝尔物理奖介绍2007：巨磁阻和自旋电子学/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Ray Chang"><meta itemprop="description" content="Think Difficulty"><meta itemprop="image" content="/logo.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Ray's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/313616/诺贝尔物理奖介绍2007：巨磁阻和自旋电子学/" itemprop="url">诺贝尔物理奖介绍2007：巨磁阻和自旋电子学</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2013-07-07T11:08:21+08:00">2013-07-07</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/转载/" itemprop="url" rel="index"><span itemprop="name">转载</span></a></span></span> <span id="/313616/诺贝尔物理奖介绍2007：巨磁阻和自旋电子学/" class="leancloud_visitors" data-flag-title="诺贝尔物理奖介绍2007：巨磁阻和自旋电子学"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数&#58;</span><span class="leancloud-visitors-count"></span></span> <span class="post-meta-divider">|</span><span class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">1,728</span></span></div></header><div class="post-body" itemprop="articleBody"><p>2007年诺贝尔物理奖授予法国的费尔（Albert Fert）和德国的格林贝格尔（ Peter Grunberg），表彰他们发现巨磁阻现象。这个在1988年和1989年发表的发现，是科学和技术结合的完美范例：巨磁阻在发现后不到十年，就应用到商业产品中，带来硬盘性能的革命。巨磁阻的发现本身，也依赖于纳米技术的进展。而且巨磁阻技术在商业上的成功吸引了更多科研和开发，开创了自旋电子学（spintronics）这一具有巨大科学意义和应用前景的新领域。</p><p>磁阻现象是指材料的电阻在磁场存在时会变化。磁阻现象早在1850年代就被发现了。而巨磁阻现象是基于完全不同的原理，而且电阻变化程度大得多。它只在人工制造的纳米材料中才能显示。磁阻现象是感应磁场的工具之一，在1991就被用来制作硬盘的读取磁头。1997年开始，巨磁阻现象也被用在读取磁头中，使得硬盘的储存密度大大提高。</p><p>演示巨磁阻现象的基本器件是两层或多层铁磁体，由非磁性材料分开。每一层的厚度都在纳米数量级。巨磁阻是基于两个基本的物理过程。</p><p>首先，在被极化的铁磁材料中，不同自旋方向的电子（相对于材料本身极化方向）表现的电阻是不同的。这主要是因为电子能态密度的分布与自旋有关。当这些电子穿过一个非磁材料薄层而进入另一层铁磁材料时，它们能保持自己的自旋方向。这样，如果这两层铁磁材料极化方向相同，那么有一种自旋的电子在两层都经历低电阻，就会显示总体低电阻（中间的非磁材料因为很薄，对电阻影响很小）。而如果两层铁磁材料极化方向相反，那么每种自旋的电子都会经历高电阻，总体电阻也就高。这个现象费尔在1970年代就发现了。但是如何控制两层材料的相对极化方向？当时没有好的方法。</p><p>第二个物理过程是格林贝格尔在1986年报道的。被非磁材料分割的两层磁性材料之间存在着耦合。这种耦合是由渗入非磁材料的“自旋波”造成的。由于是“波”， 就有某种周期性。也就是说，当间隔的厚度变化时，这两层磁性材料的极化可以在相同和相反之间变化。如果选择合适的厚度使得两者极化相反，就得到高电阻。但是有外磁场时，磁场会强迫两者取同样的极化，而电阻就变低。这就形成了巨磁阻现象。在格林贝格尔报道这个发现后，在1988和1989年，费尔和格林贝格尔分别制作出了能演示巨磁阻现象的夹层材料。</p><p>以上的叙述听起来简单，但其中涉及很多前沿的物理问题。特别是磁性和多体作用的结合，目前还没有完整的理论，必须借助实验和理论相辅才能了解。而且，巨磁阻现象的演示也依赖于纳米技术。不仅需要（在分子水平上）精确控制每层材料的厚度，而且材料间的界面必须光滑以减少电子散射。这些要求需要由八十年代才广泛使用的分子束外延（MBE）与光学监控自旋波的技术结合起来才能满足。所以，巨磁阻的发现是科学和技术的结晶。</p><p>基于半导体的电子学在过去半个世纪给人类社会带来了翻天覆地的变化。随着我们对自旋的了解深入，“自旋电子学”应运而生。利用电子自旋的变化来处理信息，开辟了电子学的新天地。自旋的响应速度快，能耗低，可以保持和加速目前电子器件小型化，高速化的势头，也可以制造全新功能的器件。</p><p>但是目前，自旋电子学还在起步阶段。它所需的基础技术：自旋极化的电子群（简称自旋电子）的产生，控制和探测，都还在研究阶段。虽然已经取得很大进展，但离实际应用还很远。但是，目前除了巨磁阻磁头外，也已经有了一些很有应用希望的技术。</p><p>比较成熟的一个是磁内存（MRAM）。它的基本结构是两层铁磁体，中间隔一层非磁体。一层铁磁体的极化方向是固定的。而另一层则随储存的数位（0或1）而变化（与固定层相同或相反）。这种器件的读取是利用以上介绍的巨磁阻效应，即垂直通过这些界面的电阻在同向极化时小而反向极化时大。而最新的存写技术，则是利用“自旋矩转移”（spin torque transfer）的原理。当自旋电子进入铁磁材料时，它与当地的磁矩作用而改变铁磁材料的极化方向。这种磁内存已经商业化。它和目前广泛使用的闪存（flash memory）一样，在断电后仍能保存数据。但它的速度，功耗和寿命均远远优于闪存。有人预期，它还有望取代目前的动态内存（DRAM），而大大减少设备的功耗。</p><p>以上提到的自旋距转移会造成“负电阻”的非线性现象，即随着电流加大，两端的电压反而降低。这个特性可以用作微波震荡器。这种纳米尺度的震荡器可以由外磁场或偏置电流来控制频率，也有很大的应用前景。</p><p>另一个诱人的潜在应用是量子计算机。量子计算机的基本组成部分是“量子位”（qbit）。每个量子位以其量子态来代表一个单元的信息。它们相互作用来完成计算。自旋态因为其相对稳定性，是量子位的很好候选者。当然量子计算机本身还在非常初级的阶段，自旋量子位也还只是一个研究课题。</p><p>巨磁阻的发现迄今不到二十年，而自旋电子学已经得到了广泛的重视。展望未来，自旋电子学有可能与半导体，激光一样成为物理学给予人类文明的又一大贡献。</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.love4026.org/313613/使用php将大文件导入到数据库中/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Ray Chang"><meta itemprop="description" content="Think Difficulty"><meta itemprop="image" content="/logo.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Ray's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/313613/使用php将大文件导入到数据库中/" itemprop="url">使用php将大文件导入到数据库中</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2013-06-22T10:55:14+08:00">2013-06-22</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/转载/" itemprop="url" rel="index"><span itemprop="name">转载</span></a></span></span> <span id="/313613/使用php将大文件导入到数据库中/" class="leancloud_visitors" data-flag-title="使用php将大文件导入到数据库中"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数&#58;</span><span class="leancloud-visitors-count"></span></span> <span class="post-meta-divider">|</span><span class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">249</span></span></div></header><div class="post-body" itemprop="articleBody"><p>将 170w行的txt文件.按行把数据导入到数据库中.</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">header ( <span class="string">"Content-type: text/html;charset=utf-8"</span> ); </span><br><span class="line">set_time_limit(<span class="number">0</span>); </span><br><span class="line"><span class="keyword">include</span>(<span class="string">'Database.class.php'</span>); </span><br><span class="line">$db = <span class="keyword">new</span> Database(<span class="string">'127.0.0.1'</span>, <span class="string">'root'</span>, <span class="string">'root'</span>, <span class="string">'test'</span>); <span class="comment">//数据库 </span></span><br><span class="line">$fp = fopen(<span class="string">'171w.txt'</span>, <span class="string">'r'</span>); <span class="comment">//文件 </span></span><br><span class="line">$i=<span class="number">1</span>; <span class="comment">//开始行数 </span></span><br><span class="line">$array = <span class="keyword">array</span>();  <span class="comment">//用来存放从XXX-XXX行的数据的数组 </span></span><br><span class="line"><span class="comment">//回调函数 </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callback</span><span class="params">($now)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">global</span> $db, $array, $i, $fp; </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>($array)) &#123;             <span class="comment">//为了节省资源..我们只生成一次数组 </span></span><br><span class="line">        <span class="keyword">while</span> (!feof($fp)) &#123; </span><br><span class="line">           <span class="keyword">if</span>($i == $now) &#123;         <span class="comment">//循环到需要读取的行数时 </span></span><br><span class="line">               <span class="keyword">for</span>($j=$i;$j&lt;=$i+<span class="number">999</span>;$j++) &#123;         <span class="comment">//读取下面的1000行并存储到数组中 </span></span><br><span class="line">                   $array[$j] = stream_get_line($fp, <span class="number">1000000</span>, <span class="string">"\n"</span>); </span><br><span class="line">               &#125; </span><br><span class="line">               <span class="keyword">break</span>; </span><br><span class="line">           &#125; </span><br><span class="line">           stream_get_line($fp, <span class="number">1000000</span>, <span class="string">"\n"</span>);    <span class="comment">//实践证明 stream_get_line 比 fgets 快很多.. </span></span><br><span class="line">           $i++; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    $db-&gt;insert(<span class="string">"INSERT INTO test(name) VALUES('&#123;$array[$now]&#125;')"</span>);  <span class="comment">//插入到数据库中 </span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">include</span>(<span class="string">'SkiyoProcess.class.php'</span>); </span><br><span class="line">$sp = <span class="keyword">new</span> SkiyoProcess(<span class="number">2</span>, <span class="number">1000</span>, <span class="number">171000</span>);  <span class="comment">//间隔为2秒  每次插入1000条数据 一共171000行数据 </span></span><br><span class="line">$sp-&gt;process(<span class="string">'callback'</span>);</span><br></pre></td></tr></table></figure><p>原文:<a href="http://blogread.cn/it/article/1825?f=wb" target="_blank" rel="noopener">http://blogread.cn/it/article/1825?f=wb</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.love4026.org/313609/应该知道的linux技巧/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Ray Chang"><meta itemprop="description" content="Think Difficulty"><meta itemprop="image" content="/logo.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Ray's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/313609/应该知道的linux技巧/" itemprop="url">应该知道的linux技巧</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2013-06-17T03:29:54+08:00">2013-06-17</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/转载/" itemprop="url" rel="index"><span itemprop="name">转载</span></a></span></span> <span id="/313609/应该知道的linux技巧/" class="leancloud_visitors" data-flag-title="应该知道的linux技巧"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数&#58;</span><span class="leancloud-visitors-count"></span></span> <span class="post-meta-divider">|</span><span class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">3,163</span></span></div></header><div class="post-body" itemprop="articleBody"><p>这篇文章来源于Quroa的一个问答《<a href="http://www.quora.com/Linux/What-are-some-time-saving-tips-that-every-Linux-user-should-know#" target="_blank" rel="noopener">What are some time-saving tips that every Linux user should know?</a>》—— Linux用户有哪些应该知道的提高效率的技巧。我觉得挺好的，总结得比较好，把其转过来，并加了一些自己的理解。 首先，我想告诉大家，<strong>在Unix/Linux下，最有效率技巧的不是操作图形界面，而是命令行操作，因为命令行意味着自动化</strong>。如果你看过《<a href="http://coolshell.cn/articles/8619.html" title="你可能不知道的Shell" target="_blank" rel="noopener">你可能不知道的Shell</a>》以及《<a href="http://coolshell.cn/articles/7829.html" title="28个Unix/Linux的命令行神器" target="_blank" rel="noopener">28个Unix/Linux的命令行神器</a>》你就会知道Linux有多强大，这个强大完全来自于命令行，于是，就算你不知道怎么去<a href="http://coolshell.cn/articles/7186.html" title="做个环保主义的程序员" target="_blank" rel="noopener">做一个环保主义的程序员</a>，至少他们可以让你少熬点夜，从而有利于你的身体健康和性生活。下面是一个有点长的列表，正如作者所说，你并不需要知道所有的这些东西，但是如果你还在很沉重地在使用Linux的话，这些东西都值得你看一看。 （注：如果你想知道下面涉及到的命令的更多的用法，你一定要man一点。对于一些命令，你可以需要先yum或apt-get来安装一下，如果有什么问题，别忘了Google。如果你要Baidu的话，我仅代表这个地球上所有的生物包括微生物甚至细菌病毒和小强BS你到宇宙毁灭）</p><h4 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h4><ul><li><p><strong>学习 <a href="http://www.quora.com/Bash-shell" target="_blank" rel="noopener">Bash</a></strong> 。你可以man bash来看看bash的东西，并不复杂也并不长。你用别的shell也行，但是bash是很强大的并且也是系统默认的。（学习zsh或tsch只会让你在很多情况下受到限制）</p></li><li><p><strong>学习 vim</strong> 。在Linux下，基本没有什么可与之竞争的编<del>译</del>辑器（就算你是一个Emacs或Eclipse的重度用户）。你可以看看《<a href="http://coolshell.cn/articles/5426.html" title="简明 Vim 练级攻略" target="_blank" rel="noopener">简明vim攻略</a>》和 《<a href="http://coolshell.cn/articles/7166.html" title="游戏：VIM大冒险" target="_blank" rel="noopener">Vim的冒险游戏</a>》以及《<a href="http://coolshell.cn/articles/5479.html" title="给程序员的VIM速查卡" target="_blank" rel="noopener">给程序员的Vim速查卡</a>》还有《<a href="http://coolshell.cn/articles/894.html" title="将vim变得简单:如何在vim中得到你最喜爱的IDE特性" target="_blank" rel="noopener">把Vim变成一个编程的IDE</a>》等等。</p></li><li><p><strong>了解 ssh</strong>。明白不需要口令的用户认证（通过ssh-agent, ssh-add），学会用ssh翻墙，用scp而不是ftp传文件，等等。你知道吗？scp 远端的时候，你可以按tab键来查看远端的目录和文件（当然，需要无口令的用户认证），这都是bash的功劳。<br>&nbsp;</p></li><li><p><strong>熟悉bash的作业管理</strong>，如： &amp;, Ctrl-Z, Ctrl-C, jobs, fg, bg, kill, 等等。当然，你也要知道Ctrl+\（SIGQUIT）和Ctrl+C （SIGINT）的区别。</p></li><li><p><strong>简单的文件管理</strong> ： ls 和 ls -l (你最好知道 “ls -l” 的每一列的意思), less, head, tail 和 tail -f, ln 和 ln -s (你知道明白hard link和soft link的不同和优缺点), chown, chmod, du (如果你想看看磁盘的大小 du -sk *), df, mount。当然，原作者忘了find命令。</p></li><li><p><strong>基础的网络管理</strong>： ip 或 ifconfig, dig。当然，原作者还忘了如netstat, ping, traceroute, 等</p></li><li><p><strong>理解正则表达式</strong>，还有grep/egrep的各种选项。比如： -o, -A, 和 -B 这些选项是很值得了解的。</p></li><li><p><strong>学习使用 apt-get 和 yum 来查找和安装软件</strong>（前者的经典分发包是Ubuntu，后者的经典分发包是Redhat），我还建议你试着从源码编译安装软件。<br><strong>日常</strong></p></li><li><p>在 bash 里，使用 Ctrl-R 而不是上下光标键来查找历史命令。</p></li><li><p>在 bash里，使用 Ctrl-W 来删除最后一个单词，使用 Ctrl-U 来删除一行。请man bash后查找Readline Key Bindings一节来看看bash的默认热键，比如：Alt-. 把上一次命令的最后一个参数打出来，而Alt-* 则列出你可以输入的命令。</p></li><li><p>回到上一次的工作目录： cd – （回到home是 cd ~）</p></li><li><p>使用 xargs。这是一个很强大的命令。你可以使用-L来限定有多少个命令，也可以用-P来指定并行的进程数。如果你不知道你的命令会变成什么样，你可以使用xargs echo来看看会是什么样。当然， -I{} 也很好用。示例：</p><blockquote><div><br><br><div id="highlighter_680398"><br><br><table border="0" cellspacing="0" cellpadding="0"><br><br><tbody><br><br><tr><br><br><td><br><br><div>1</div><div>2</div><div>3</div></td><br><br><td><br><br><div><br><br><div><code>find</code> <code>. -name \*.py | `</code>xargs<code></code>grep<code></code>some_function`</div><div></div><div><code>cat</code> <code>hosts | `</code>xargs<code></code>-I{} <code>ssh` `root@{}</code>hostname`</div><p></p></div></td><p></p><p></p></tr><p></p><p></p></tbody><p></p><p></p></table><p></p><p></p></div><p></p><p></p></div><p></p></blockquote></li><li><p>pstree -p 可以帮你显示进程树。（读过我的那篇《<a href="http://coolshell.cn/articles/7965.html" title="一个fork的面试题" target="_blank" rel="noopener">一个fork的面试题</a>》的人应该都不陌生）</p></li><li><p>使用 pgrep 和 pkill 来找到或是kill 某个名字的进程。 (-f 选项很有用).</p></li><li><p>了解可以发给进程的信号。例如：要挂起一个进程，使用 kill -STOP [pid]. 使用 man 7 signal 来查看各种信号，使用kill -l 来查看数字和信号的对应表</p></li><li><p>使用 nohup 或 disown 如果你要让某个进程运行在后台。</p></li><li><p>使用netstat -lntp来看看有侦听在网络某端口的进程。当然，也可以使用 lsof。</p></li><li><p>在bash的脚本中，你可以使用 set -x 来debug输出。使用 set -e 来当有错误发生的时候abort执行。考虑使用 set -o pipefail 来限制错误。还可以使用trap来截获信号（如截获ctrl+c）。</p></li><li><p>在bash 脚本中，subshells (写在圆括号里的) 是一个很方便的方式来组合一些命令。一个常用的例子是临时地到另一个目录中，例如：</p><blockquote><div><br><br><div id="highlighter_713913"><br><br><table border="0" cellspacing="0" cellpadding="0"><br><br><tbody><br><br><tr><br><br><td><br><br><div>1</div><div>2</div><div>3</div></td><br><br><td><br><br><div><br><br><div><code># do something in current dir</code></div><div><code>(`</code>cd<code></code>/some/other/dir<code>; other-</code>command<code></code>)`</div><div><code># continue in original dir</code></div><p></p></div></td><p></p><p></p></tr><p></p><p></p></tbody><p></p><p></p></table><p></p><p></p></div><p></p><p></p></div><p></p></blockquote></li><li><p>在 bash 中，注意那里有很多的变量展开。如：检查一个变量是否存在: ${name:?error message}。如果一个bash的脚本需要一个参数，也许就是这样一个表达式 input_file=${1:?usage: $0 input_file}。一个计算表达式： i=$(( (i + 1) % 5 ))。一个序列： {1..10}。 截断一个字符串： ${var%suffix} 和 ${var#prefix}。 示例： if var=foo.pdf, then echo ${var%.pdf}.txt prints “foo.txt”.</p></li><li><p>通过 &lt;(some command) 可以把某命令当成一个文件。示例：比较一个本地文件和远程文件 /etc/hosts： diff /etc/hosts &lt;(ssh somehost cat /etc/hosts)</p></li><li><p>了解什么叫 “<a href="http://zh.wikipedia.org/wiki/Here%E6%96%87%E6%A1%A3" target="_blank" rel="noopener">here documents</a>” ，就是诸如 cat &lt;&lt;EOF 这样的东西。</p></li><li><p>在 bash中，使用重定向到标准输出和标准错误。如： some-command &gt;logfile 2&gt;&amp;1。另外，要确认某命令没有把某个打开了的文件句柄重定向给标准输入，最佳实践是加上 “&lt;/dev/null”，把/dev/null重定向到标准输入。</p></li><li><p>使用 man ascii 来查看 ASCII 表。</p></li><li><p>在远端的 ssh 会话里，使用 screen 或 dtach 来保存你的会话。（参看《<a href="http://coolshell.cn/articles/7829.html" title="28个Unix/Linux的命令行神器" target="_blank" rel="noopener">28个Unix/Linux的命令行神器</a>》）</p></li><li><p>要来debug Web，试试curl 和 curl -I 或是 wget 。我觉得debug Web的利器是firebug，curl和wget是用来抓网页的，呵呵。</p></li><li><p>把 HTML 转成文本： lynx -dump -stdin</p></li><li><p>如果你要处理XML，使用 xmlstarlet</p></li><li><p>对于 Amazon S3， s3cmd 是一个很方便的命令（还有点不成熟）</p></li><li><p>在 ssh中，知道怎么来使用ssh隧道。通过 -L or -D (还有-R) ，翻墙神器。</p></li><li><p>你还可以对你的ssh 做点优化。比如，.ssh/config 包含着一些配置：避免链接被丢弃，链接新的host时不需要确认，转发认证，以前使用压缩（如果你要使用scp传文件）：</p><blockquote><div><br><br><div id="highlighter_742521"><br><br><table border="0" cellspacing="0" cellpadding="0"><br><br><tbody><br><br><tr><br><br><td><br><br><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div></td><br><br><td><br><br><div><br><br><div><code>TCPKeepAlive=`</code>yes`</div><div><code>ServerAliveInterval=15</code></div><div><code>ServerAliveCountMax=6</code></div><div><code>StrictHostKeyChecking=no</code></div><div><code>Compression=`</code>yes`</div><div><code>ForwardAgent=`</code>yes`</div><p></p></div></td><p></p><p></p></tr><p></p><p></p></tbody><p></p><p></p></table><p></p><p></p></div><p></p><p></p></div><p></p></blockquote></li><li><p>如果你有输了个命令行，但是你改变注意了，但你又不想删除它，因为你要在历史命令中找到它，但你也不想执行它。那么，你可以按下 Alt-# ，于是这个命令关就被加了一个#字符，于是就被注释掉了。<br><strong>数据处理</strong></p></li><li><p>了解 sort 和 uniq 命令 (包括 uniq 的 -u 和 -d 选项).</p></li><li><p>了解用 cut, paste, 和 join 命令来操作文本文件。很多人忘了在cut前使用join。</p></li><li><p>如果你知道怎么用sort/uniq来做集合交集、并集、差集能很大地促进你的工作效率。假设有两个文本文件a和b已解被 uniq了，那么，用sort/uniq会是最快的方式，无论这两个文件有多大（sort不会被内存所限，你甚至可以使用-T选项，如果你的/tmp目录很小）</p><blockquote><div><br><br><div id="highlighter_570665"><br><br><table border="0" cellspacing="0" cellpadding="0"><br><br><tbody><br><br><tr><br><br><td><br><br><div>1</div><div>2</div><div>3</div><div>4</div><div>5</div></td><br><br><td><br><br><div><br><br><div><code>cat</code> <code>a b | `</code>sort<code></code>| <code>uniq` `&amp;gt; c</code># c is a union b 并集`</div><div></div><div><code>cat</code> <code>a b | `</code>sort<code></code>| <code>uniq` `-d &amp;gt; c</code># c is a intersect b 交集`</div><div></div><div><code>cat</code> <code>a b b | `</code>sort<code></code>| <code>uniq` `-u &amp;gt; c</code># c is set difference a - b 差集`</div><p></p></div></td><p></p><p></p></tr><p></p><p></p></tbody><p></p><p></p></table><p></p><p></p></div><p></p><p></p></div><p></p></blockquote></li><li><p>了解和字符集相关的命令行工具，包括排序和性能。很多的Linux安装程序都会设置LANG 或是其它和字符集相关的环境变量。这些东西可能会让一些命令（如：sort）的执行性能慢N多倍（注：就算是你用UTF-8编码文本文件，你也可以很安全地使用ASCII来对其排序）。如果你想Disable那个i18n 并使用传统的基于byte的排序方法，那就设置export LC_ALL=C （实际上，你可以把其放在 .bashrc）。如果这设置这个变量，你的sort命令很有可能会是错的。</p></li><li><p>了解 awk 和 sed，并用他们来做一些简单的数据修改操作。例如：求第三列的数字之和： awk ‘{ x += $3 } END { print x }’。这可能会比Python快3倍，并比Python的代码少三倍。</p></li><li><p>使用 shuf 来打乱一个文件中的行或是选择文件中一个随机的行。</p></li><li><p>了解sort命令的选项。了解key是什么（-t和-k）。具体说来，你可以使用-k1,1来对第一列排序，-k1来对全行排序。</p></li><li><p>Stable sort (sort -s) 会很有用。例如：如果你要想对两例排序，先是以第二列，然后再以第一列，那么你可以这样： sort -k1,1 | sort -s -k2,2</p></li><li><p>我们知道，在bash命令行下，Tab键是用来做目录文件自动完成的事的。但是如果你想输入一个Tab字符（比如：你想在sort -t选项后输入&lt;tab&gt;字符），你可以先按Ctrl-V，然后再按Tab键，就可以输入&lt;tab&gt;字符了。当然，你也可以使用$’\t’。</p></li><li><p>如果你想查看二进制文件，你可以使用hd命令（在CentOS下是hexdump命令），如果你想编译二进制文件，你可以使用bvi命令（<a href="http://bvi.sourceforge.net/" target="_blank" rel="noopener">http://bvi.sourceforge.net/</a> 墙）</p></li><li><p>另外，对于二进制文件，你可以使用strings（配合grep等）来查看二进制中的文本。</p></li><li><p>对于文本文件转码，你可以试一下 iconv。或是试试更强的 uconv 命令（这个命令支持更高级的Unicode编码）</p></li><li><p>如果你要分隔一个大文件，你可以使用split命令（split by size）和csplit命令（split by a pattern）。<br><strong>系统调试</strong></p></li><li><p>如果你想知道磁盘、CPU、或网络状态，你可以使用 iostat, netstat, top (或更好的 htop), 还有 dstat 命令。你可以很快地知道你的系统发生了什么事。关于这方面的命令，还有iftop, iotop等（参看《<a href="http://coolshell.cn/articles/7829.html" title="28个Unix/Linux的命令行神器" target="_blank" rel="noopener">28个Unix/Linux的命令行神器</a>》）</p></li><li><p>要了解内存的状态，你可以使用free和vmstat命令。具体来说，你需要注意 “cached” 的值，这个值是Linux内核占用的内存。还有free的值。</p></li><li><p>Java 系统监控有一个小的技巧是，你可以使用kill -3 &lt;pid&gt; 发一个SIGQUIT的信号给JVM，可以把堆栈信息（包括垃圾回收的信息）dump到stderr/logs。</p></li><li><p>使用 mtr 会比使用 traceroute 要更容易定位一个网络问题。</p></li><li><p>如果你要找到哪个socket或进程在使用网络带宽，你可以使用 iftop 或 nethogs。</p></li><li><p>Apache的一个叫 ab 的工具是一个很有用的，用quick-and-dirty的方式来测试网站服务器的性能负载的工作。如果你需要更为复杂的测试，你可以试试 siege。</p></li><li><p>如果你要抓网络包的话，试试 wireshark 或 tshark。</p></li><li><p>了解 strace 和 ltrace。这两个命令可以让你查看进程的系统调用，这有助于你分析进程的hang在哪了，怎么crash和failed的。你还可以用其来做性能profile，使用 -c 选项，你可以使用-p选项来attach上任意一个进程。</p></li><li><p>了解用ldd命令来检查相关的动态链接库。注意：<a href="http://coolshell.cn/articles/1626.html" title="ldd 的一个安全问题" target="_blank" rel="noopener">ldd的安全问题</a></p></li><li><p>使用gdb来调试一个正在运行的进程或分析core dump文件。参看我写的《<a href="http://coolshell.cn/articles/3643.html" title="GDB中应该知道的几个调试方法" target="_blank" rel="noopener">GDB中应该知道的几个调试方法</a>》</p></li><li><p>学会到 /proc 目录中查看信息。这是一个Linux内核运行时记录的整个操作系统的运行统计和信息，比如： /proc/cpuinfo, /proc/xxx/cwd, /proc/xxx/exe, /proc/xxx/fd/, /proc/xxx/smaps.</p></li><li><p>如果你调试某个东西为什么出错时，sar命令会有用。它可以让你看看 CPU, 内存, 网络, 等的统计信息。</p></li><li><p>使用 dmesg 来查看一些硬件或驱动程序的信息或问题。<br>作者最后加了一个免责声明：Disclaimer: Just because you <em>can</em> do something in bash, doesn’t necessarily mean you should. ;) （全文完）</p></li></ul><p><a href="http://coolshell.cn/articles/8883.html" target="_blank" rel="noopener">http://coolshell.cn/articles/8883.html</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.love4026.org/313606/28个unixlinux的命令行神器/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Ray Chang"><meta itemprop="description" content="Think Difficulty"><meta itemprop="image" content="/logo.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Ray's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/313606/28个unixlinux的命令行神器/" itemprop="url">28个unixlinux的命令行神器</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2013-06-17T03:25:35+08:00">2013-06-17</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/转载/" itemprop="url" rel="index"><span itemprop="name">转载</span></a></span></span> <span id="/313606/28个unixlinux的命令行神器/" class="leancloud_visitors" data-flag-title="28个unixlinux的命令行神器"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数&#58;</span><span class="leancloud-visitors-count"></span></span> <span class="post-meta-divider">|</span><span class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">2,809</span></span></div></header><div class="post-body" itemprop="articleBody"><p>下面是<a href="http://kkovacs.eu/" target="_blank" rel="noopener">Kristóf Kovács</a>收集的28个Unix/Linux下的28个命令行下的工具（<a href="http://kkovacs.eu/cool-but-obscure-unix-tools" target="_blank" rel="noopener">原文链接</a>），有一些是大家熟悉的，有一些是非常有用的，有一些是不为人知的。这些工具都非常不错，希望每个人都知道。本篇文章还在<a href="http://news.ycombinator.com/item?id=2567186" target="_blank" rel="noopener">Hacker News上被讨论</a>，你可以过去看看。我以作者的原文中加入了官网链接和一些说明。</p><div><h4 id="dstat-amp-sar"><a href="#dstat-amp-sar" class="headerlink" title="dstat &amp; sar"></a>dstat &amp; sar</h4><p>iostat, vmstat, ifstat 三合一的工具，用来查看系统性能（我在《<a href="http://coolshell.cn/articles/7490.html" title="性能调优攻略" target="_blank" rel="noopener">性能调优攻略</a>》中提到过那三个xxstat工具）。</p><p>官方网站：<a href="http://dag.wieers.com/rpm/packages/dstat/" target="_blank" rel="noopener">http://dag.wieers.com/rpm/packages/dstat/</a></p><p>你可以这样使用：</p><p><code>alias</code> <code>dstat=`</code>‘dstat -cdlmnpsy’`</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/dstat_screenshot.png" alt="dstat screenshot"></p><h4 id="slurm"><a href="#slurm" class="headerlink" title="slurm"></a>slurm</h4><p>查看网络流量的一个工具</p><p>官方网站：_ <a href="https://computing.llnl.gov/linux/slurm/" target="_blank" rel="noopener">Simple Linux Utility for Resource Management</a>_</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/slurm_screenshot.png" alt="slurm screenshot"></p><h4 id="vim-amp-emacs"><a href="#vim-amp-emacs" class="headerlink" title="vim &amp; emacs"></a>vim &amp; emacs</h4><p>真正程序员的代码编辑器。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/vim_screenshot.png" alt="vim screenshot"></p><h4 id="screen-dtach-tmux-byobu"><a href="#screen-dtach-tmux-byobu" class="headerlink" title="screen, dtach, tmux, byobu"></a>screen, dtach, tmux, byobu</h4><p>你是不是经常需要 SSH 或者 telent 远程登录到 Linux 服务器？你是不是经常为一些长时间运行的任务而头疼，比如系统备份、ftp 传输等等。通常情况下我们都是为每一个这样的任务开一个远程终端窗口，因为他们执行的时间太长了。必须等待它执行完毕，在此期间可不能关掉窗口或者断开连接，否则这个任务就会被杀掉，一切半途而废了。</p><p><a href="http://www.gnu.org/software/screen/" target="_blank" rel="noopener"><strong>Screen</strong></a>是一个可以在多个进程之间多路复用一个物理终端的窗口管理器。Screen中有会话的概念，用户可以在一个screen会话中创建多个screen窗口，在每一个screen窗口中就像操作一个真实的telnet/SSH连接窗口那样。请参看IBM DeveloperWorks的这篇文章《<a href="http://www.ibm.com/developerworks/cn/linux/l-cn-screen/" target="_blank" rel="noopener">使用 screen 管理你的远程会话</a>》</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/gnu_screen_screenshot.png" alt="gnu screen screenshot"></p><p><a href="http://dtach.sourceforge.net/" target="_blank" rel="noopener"><strong>dtach</strong></a> 是用来模拟screen的detach的功能的小工具，其可以让你随意地attach到各种会话上 。下图为dtach+dvtm的样子。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/dtach+dvtm.png" alt="" title="dtach+dvtm"></p><p><strong><a href="http://tmux.sourceforge.net/" title="http://tmux.sourceforge.net/" target="_blank" rel="noopener">tmux</a></strong>是一个优秀的终端复用软件，类似<a href="http://www.gnu.org/software/screen/" title="http://www.gnu.org/software/screen/" target="_blank" rel="noopener">GNU Screen</a>，但来自于OpenBSD，采用BSD授权。使用它最直观的好处就是，通过一个终端登录远程主机并运行tmux后，在其中可以开启多个控制台而无需再“浪费”多余的终端来连接这台远程主机；当然其功能远不止于此。与screen相比的优点：可以横向和纵向分割窗口，且窗格可以自由移动和调整大小。可在多个缓冲区进行复制和粘贴，支持跨窗口搜索；非正常断线后不需重新detach；…… 有人说——<strong>与tmux相比，screen简直弱爆了</strong>。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/tmux3.png" alt="" title="tmux"></p><p><a href="https://launchpad.net/byobu/" target="_blank" rel="noopener"><strong>byobu</strong></a>是Ubuntu开发的，在Screen的基础上进行包装，使其更加易用的一个工具。最新的Byobu，已经是基于Tmux作为后端了。可通过“byobu-tmux”这个命令行前端来接受各种与tmux一模一样的参数来控制它。Byobu的细节做的非常好，效果图如下：<img src="http://coolshell.cn//wp-content/uploads/2012/07/byobu-tmux.jpg" alt="" title="byobu-tmux"></p><h4 id="multitail"><a href="#multitail" class="headerlink" title="multitail"></a>multitail</h4><p>MultiTail是个用来实现同时监控多个文档、类似tail命令的功能的软件。他和tail的区别就是他会在控制台中打开多个窗口，这样使同时监控多个日志文档成为可能。他还可以看log文件的统计，合并log文件，过滤log文件，分屏，……。</p><p>官网：<a href="http://www.vanheusden.com/multitail/" target="_blank" rel="noopener">http://www.vanheusden.com/multitail/</a></p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/multitail_screenshot.png" alt="multitail screenshot"></p><h4 id="tpp"><a href="#tpp" class="headerlink" title="tpp"></a>tpp</h4><p>终端下的PPT，要是在某某大会上用这个演示PPT，就太TMD的Geek了。</p><p>官网：<a href="http://www.ngolde.de/tpp.html" target="_blank" rel="noopener">http://www.ngolde.de/tpp.html</a></p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/tpp_screenshot.png" alt="tpp screenshot"></p><h4 id="xargs-amp-parallel"><a href="#xargs-amp-parallel" class="headerlink" title="xargs &amp; parallel"></a>xargs &amp; parallel</h4><p>Executes tasks from input (even multithread).</p><p>xargs 是一个比较古老的命令，有简单的并行功能，这个不说了。对于<a href="http://www.gnu.org/software/parallel/" target="_blank" rel="noopener">GNU parallel</a> ( <a href="http://savannah.gnu.org/projects/parallel" target="_blank" rel="noopener">online manpage</a> )来说，它不仅能够处理本机上多执行绪，还能分散至远端电脑协助处理。而使用GNU parallel前，要先确定本机有安装GNU parallel / ssh / rsync，远端电脑也要安装ssh。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/xargs_screenshot.png" alt="xargs screenshot"></p><h4 id="duplicity-amp-rsyncrypto"><a href="#duplicity-amp-rsyncrypto" class="headerlink" title="duplicity &amp; rsyncrypto"></a>duplicity &amp; rsyncrypto</h4><p><a href="http://duplicity.nongnu.org/" target="_blank" rel="noopener">Duplicity</a>是使用rsync算法加密的高效率备份软件，Duplicity支持目录加密生产和格式上传到远程或本地文件服务器。</p><p><a href="http://rsyncrypto.lingnu.com/index.php/Home_Page" target="_blank" rel="noopener">rsyncrypto</a> 就是 rsync + encryption。对于rsync的算法可参看酷壳的<a href="http://coolshell.cn/articles/7425.html" title="rsync 的核心算法" target="_blank" rel="noopener">rsync核心算法</a>。</p><p>Encrypting backup tools.</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/duplicity_screenshot.png" alt="duplicity screenshot"></p><h4 id="nethack-amp-slash’em"><a href="#nethack-amp-slash’em" class="headerlink" title="nethack &amp; slash’em"></a>nethack &amp; slash’em</h4><p><a href="http://www.nethack.org/" target="_blank" rel="noopener">NetHack</a>（<a href="http://zh.wikipedia.org/zh/NetHack" target="_blank" rel="noopener">Wiki</a>），20年历史的古老电脑游戏。没有声音，没有漂亮的界面，不过这个游戏真的很有意思。网上有个家伙说：<strong>如果你一生只做一件事情，那么玩NetHack</strong>。这句话很惹眼，但也让人觉得这个游戏很复杂不容易上手。其实，这个游戏很虽然很复杂，却容易上手。虽然玩通关很难，但上手很容易。NetHack上有许多复杂的规则，”the DevTeam thinks of everything”（开发团队想到了所有的事情)。各种各样的怪物，各种各样的武器….，有许多spoilers文件来说明其规则。除了每次开始随机生成的地图，每次玩游戏，你也都会碰到奇怪的事情: 因为喝了一种药水，变成了机器人;因为踢坏了商店的门被要求高价赔偿;你的狗为你偷来了商店的东西….. 这有点象人生，你不能完全了解这个世界，但你仍然可以选择自己的面对方式。</p><p>网上有许多文章所这是最好的电脑游戏或最好的电脑游戏之一。也许是因为它开放的源代码让人赞赏，古老的历史让人宽容，复杂的规则让人敬畏。虽然它不是当前流行的游戏，但它比任何一个当前流行的游戏都更有可能再经受20年的考验。</p><p><a href="http://www.slashem.org/" target="_blank" rel="noopener">Slash’EM</a> 也是一个基于NetHack的经典游戏。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/nethack_screenshot.png" alt="nethack screenshot"></p><h4 id="lftp"><a href="#lftp" class="headerlink" title="lftp"></a>lftp</h4><p>利用<a href="http://lftp.yar.ru/" target="_blank" rel="noopener">lftp</a>命令行ftp工具进行网站数据的增量备份，镜像，就像使用rsync一样。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/lftp_screenshot.png" alt="lftp screenshot"></p><h4 id="ack"><a href="#ack" class="headerlink" title="ack"></a>ack</h4><p><a href="http://betterthangrep.com/" target="_blank" rel="noopener">ack</a>是一个perl脚本，是grep的一个可选替换品。其可以对匹配字符有高亮显示。是为程序员专门设计的，默认递归搜索，省提供多种文件类型供选。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/ack_screenshot.png" alt="ack screenshot"></p><h4 id="calcurse-amp-remind-wyrd"><a href="#calcurse-amp-remind-wyrd" class="headerlink" title="calcurse &amp; remind + wyrd"></a>calcurse &amp; remind + wyrd</h4><p><a href="http://calcurse.org/" target="_blank" rel="noopener">calcurse</a>是一个命令行下的日历和日程软件。<a href="http://www.roaringpenguin.com/products/remind" target="_blank" rel="noopener">remind</a> + <a href="http://pessimization.com/software/wyrd/" target="_blank" rel="noopener">wyrd</a>也很类似。关于日历，我不得不提一个<a href="http://coolshell.cn/articles/3489.html" title="Linux的cycle日历（你懂的）" target="_blank" rel="noopener">Linux的Cycle日历</a>，也是一个神器，呵呵。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/calcurse_screenshot.png" alt="calcurse screenshot"></p><h4 id="newsbeuter-amp-rsstail"><a href="#newsbeuter-amp-rsstail" class="headerlink" title="newsbeuter &amp; rsstail"></a>newsbeuter &amp; rsstail</h4><p><a href="http://newsbeuter.org/" target="_blank" rel="noopener">newsbeuter</a> 和 <a href="http://www.vanheusden.com/rsstail/" target="_blank" rel="noopener">rsstail</a> 是命令行下RSS的阅读工具。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/newsbeuter_screenshot.png" alt="newsbeuter screenshot"></p><h4 id="powertop"><a href="#powertop" class="headerlink" title="powertop"></a>powertop</h4><p><a href="http://coolshell.cn/articles/7186.html" title="做个环保主义的程序员" target="_blank" rel="noopener">做个环保的程序员</a>，看看自己的电脑里哪些程序费电。<a href="https://01.org/powertop/" target="_blank" rel="noopener">PowerTOP</a> 是一个让 Intel 平台的笔记本电脑节省电源的 Linux 工具。此工具由 Intel 公司发布。它可以帮助用户找出那些耗电量大的程序，通过修复或者关闭那些应用程序或进程，从而为用户节省电源。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/powertop_screenshot.png" alt="powertop screenshot"></p><h4 id="htop-amp-iotop"><a href="#htop-amp-iotop" class="headerlink" title="htop &amp; iotop"></a>htop &amp; iotop</h4><p><a href="http://htop.sourceforge.net/" target="_blank" rel="noopener">htop</a> 和 <a href="http://guichaz.free.fr/iotop/" target="_blank" rel="noopener">iotop</a> 用来查看进程，内存和IO负载。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/htop_screenshot.png" alt="htop screenshot"></p><h4 id="ttyrec-amp-ipbt"><a href="#ttyrec-amp-ipbt" class="headerlink" title="ttyrec &amp; ipbt"></a>ttyrec &amp; ipbt</h4><p><a href="http://0xcc.net/ttyrec/index.html.en" target="_blank" rel="noopener">ttyrec</a> 是一个 tty 控制台录制程序，其所录制的数据文件可以使用与之配套的 ttyplay 播放。不管是你在 tty 中的各种操作，还是在 tty 中耳熟能详的软件，都可进行录制。</p><p><a href="http://www.chiark.greenend.org.uk/~sgtatham/ipbt/" target="_blank" rel="noopener">ipbt</a> 是一个用来回放 ttyrec 所录制的控制台输入过程的工具。</p><p>与此类似的还有<a href="http://shelr.tv/" target="_blank" rel="noopener">Shelr</a> 和 <a href="http://sourceforge.net/projects/termrec/" target="_blank" rel="noopener">termrec</a></p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/ipbt_screenshot.png" alt="ipbt screenshot"></p><h4 id="rsync"><a href="#rsync" class="headerlink" title="rsync"></a>rsync</h4><p>通过SSH进行文件同步的经典工具（<a href="http://coolshell.cn/articles/7425.html" title="rsync 的核心算法" target="_blank" rel="noopener">核心算法</a>）</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/rsync_screenshot.png" alt="rsync screenshot"></p><h4 id="mtr"><a href="#mtr" class="headerlink" title="mtr"></a>mtr</h4><p><a href="http://www.bitwizard.nl/mtr/" target="_blank" rel="noopener">MTR</a> – traceroute 2.0，其是把 traceroute 和 ping 集成在一块的一个小工具 用于诊断网络。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/mtr_screenshot.png" alt="mtr screenshot"></p><h4 id="socat-amp-netpipes"><a href="#socat-amp-netpipes" class="headerlink" title="socat &amp; netpipes"></a>socat &amp; netpipes</h4><p><a href="http://www.dest-unreach.org/socat/" target="_blank" rel="noopener">socat</a>是一个多功能的网络工具，名字来由是” Socket CAT”，可以看作是netcat的N倍加强版。</p><p><a href="http://web.purplefrog.com/~thoth/netpipes/" target="_blank" rel="noopener">netpipes</a> 和socat一样，主要是用来在命令行来进行socket操作的命令，这样你就可以在Shell脚本下行进socket网络通讯了。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/socat_screenshot.png" alt="socat screenshot"></p><h4 id="iftop-amp-iptraf"><a href="#iftop-amp-iptraf" class="headerlink" title="iftop &amp; iptraf"></a>iftop &amp; iptraf</h4><p><a href="http://www.ex-parrot.com/~pdw/iftop/" target="_blank" rel="noopener">iftop</a>和<a href="http://iptraf.seul.org/" target="_blank" rel="noopener">iptraf</a>可以用来查看当前网络链接的一些流量情况。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/iftop_screenshot.png" alt="iftop screenshot"></p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/iptraf-tcpudp.gif" alt="" title="iptraf-tcpudp"></p><h4 id="siege-amp-tsung"><a href="#siege-amp-tsung" class="headerlink" title="siege &amp; tsung"></a>siege &amp; tsung</h4><p><a href="http://www.joedog.org/siege-home/" target="_blank" rel="noopener">Siege</a>是一个压力测试和评测工具，设计用于WEB开发这评估应用在压力下的承受能力：可以根据配置对一个WEB站点进行多用户的并发访问，记录每个用户所有请求过程的相应时间，并在一定数量的并发访问下重复进行。</p><p><a href="http://tsung.erlang-projects.org/" target="_blank" rel="noopener">Tsung</a> 是一个压力测试工具，可以测试包括HTTP, WebDAV, PostgreSQL, MySQL, LDAP, and XMPP/Jabber等服务器。针对 HTTP 测试，Tsung 支持 HTTP 1.0/1.1 ，包含一个代理模式的会话记录、支持 GET、POST 和 PUT 以及 DELETE 方法，支持 Cookie 和基本的 WWW 认证，同时还支持 SSL。</p><p>参看：<a href="http://coolshell.cn/articles/2589.html" title="十个免费的Web压力测试工具" target="_blank" rel="noopener">十个免费的Web压力测试工具</a></p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/siege_screenshot.png" alt="siege screenshot"></p><h4 id="ledger"><a href="#ledger" class="headerlink" title="ledger"></a>ledger</h4><p><a href="http://ledger-cli.org/" target="_blank" rel="noopener">ledger</a> 一个命令行下记帐的小工具。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/ledger_screenshot.png" alt="ledger screenshot"></p><h4 id="taskwarrior"><a href="#taskwarrior" class="headerlink" title="taskwarrior"></a>taskwarrior</h4><p><a href="http://taskwarrior.org/projects/show/taskwarrior" target="_blank" rel="noopener">TaskWarrior</a> 是一个基于命令行的 TODO 列表管理工具。主要功能包括：标签、彩色表格输出、报表和图形、大量的命令、底层API、多用户文件锁等功能。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/taskwarrior_screenshot.png" alt="taskwarrior screenshot"></p><p>下图是TaskWarrior 2.0的界面：</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/TaskWarrior2.0.png" alt="" title="TaskWarrior2.0"></p><h4 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h4><p><a href="http://curl.haxx.se/" target="_blank" rel="noopener">cURL</a>是一个利用URL语法在命令行下工作的文件传输工具，1997年首次发行。它支持文件上传和下载，所以是综合传输工具，但按传统，习惯称cURL为下载工具。cURL还包含了用于程序开发的libcurl。cURL支援的通訊協定有FTP、FTPS、HTTP、HTTPS、TFTP、SFTP、Gopher、SCP、Telnet、DICT、FILE、LDAP、LDAPS、IMAP、POP3、SMTP和RTSP。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/curl_screenshot.png" alt="curl screenshot"></p><h4 id="rtorrent-amp-aria2"><a href="#rtorrent-amp-aria2" class="headerlink" title="rtorrent &amp; aria2"></a>rtorrent &amp; aria2</h4><p><a href="http://libtorrent.rakshasa.no/" target="_blank" rel="noopener">rTorrent</a> 是一个非常简洁、优秀、非常轻量的BT客户端. 它使用了 ncurses 库以 C++ 编写, 因此它完全基于文本并在终端中运行. 将 rTorrent 用在安装有 GNU Screen 和 Secure Shell 的低端系统上作为远程的 BT 客户端是非常理想的。</p><p><a href="http://aria2.sourceforge.net/" target="_blank" rel="noopener">aria2</a> 是 Linux 下一个不错的高速下载工具。由于它具有分段下载引擎，所以支持从多个地址或者从一个地址的多个连接来下载同一个文件。这样自然就大大加快了文件的下载速度。aria2 也具有断点续传功能，这使你随时能够恢复已经中断的文件下载。除了支持一般的 http(s) 和 ftp 协议外，aria2 还支持 BitTorrent 协议。这意味着，你也可以使用 aria2 来下载 torrent 文件。</p><p> <img src="http://coolshell.cn//wp-content/uploads/2012/07/rtorrent_screenshot.png" alt="rtorrent screenshot"></p><h4 id="ttytter-amp-earthquake"><a href="#ttytter-amp-earthquake" class="headerlink" title="ttytter &amp; earthquake"></a>ttytter &amp; earthquake</h4><p><a href="http://www.floodgap.com/software/ttytter" target="_blank" rel="noopener">TTYtter</a> 是一个Perl写的命令行上发Twitter的工具，可以进行所有其他平台客户端能进行的事情，当然，支持中文。脚本控、CLI控、终端控、Perl控的最愛。</p><p><a href="https://github.com/jugyo/earthquake" target="_blank" rel="noopener">Earthquake</a>也是一个命令行上的Twitter客户端。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/ttytter_screenshot.png" alt="ttytter screenshot"></p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/earthquake.jpg" alt="" title="earthquake"></p><h4 id="vifm-amp-ranger"><a href="#vifm-amp-ranger" class="headerlink" title="vifm &amp; ranger"></a>vifm &amp; ranger</h4><p><a href="http://vifm.sourceforge.net/" target="_blank" rel="noopener">Vifm</a> 基于ncurses的文件管理器，DOS风格，用键盘操作。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/vifm_screenshot.png" alt="vifm screenshot"></p><p><a href="http://savannah.nongnu.org/projects/ranger" target="_blank" rel="noopener">Ranger</a>用 Python 完成，默认为使用 Vim 风格的按键绑定，比如 hjkl（上下左右），dd（剪切），yy（复制）等等。功能很全，扩展/可配置性也非常不错。类似MacOS X下Finder（文件管理器）的多列文件管理方式。支持多标签页。实时预览文本文件和目录。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/ranger.png" alt="" title="ranger"></p><h4 id="cowsay-amp-sl"><a href="#cowsay-amp-sl" class="headerlink" title="cowsay &amp; sl"></a>cowsay &amp; sl</h4><p><a href="http://www.nog.net/~tony/warez/cowsay.shtml" target="_blank" rel="noopener">cowsay</a> 不说了，如下所示，哈哈哈。还有xcowsay，你可以自己搜一搜。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/cowsay_screenshot.png" alt="cowsay screenshot"></p><p>sl是什么？ls？，呵呵，你会经常把ls 打成sl吗？如果是的话，这个东西可以让你娱乐一下，你会看到一辆火车呼啸而过~~，相当拉风。你可以使用sudo apt-get install sl 安装。</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/sl.jpg" alt="" title="sl"></p><p>最后，再介绍一个命令中linuxlogo，你可以使用 sudo apt-get install linuxlogo来安装，然后，就可以使用linuxlogo -L<br>来看一下各种Linux的logo了</p><p><img src="http://coolshell.cn//wp-content/uploads/2012/07/linuxlogo.jpg" alt="" title="linuxlogo"></p><p>（全文完）</p><p><a href="http://coolshell.cn/articles/7829.html" target="_blank" rel="noopener">http://coolshell.cn/articles/7829.html</a></p></div></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.love4026.org/313603/浏览器的渲染原理简介/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Ray Chang"><meta itemprop="description" content="Think Difficulty"><meta itemprop="image" content="/logo.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Ray's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/313603/浏览器的渲染原理简介/" itemprop="url">浏览器的渲染原理简介</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2013-06-17T02:41:45+08:00">2013-06-17</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/前端设计/" itemprop="url" rel="index"><span itemprop="name">前端设计</span></a></span></span> <span id="/313603/浏览器的渲染原理简介/" class="leancloud_visitors" data-flag-title="浏览器的渲染原理简介"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数&#58;</span><span class="leancloud-visitors-count"></span></span> <span class="post-meta-divider">|</span><span class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">2,824</span></span></div></header><div class="post-body" itemprop="articleBody"><p>看到这个标题大家一定会想到这篇神文《<a href="http://taligarsiel.com/Projects/howbrowserswork1.htm" target="_blank" rel="noopener">How Browsers Work</a>》，这篇文章把浏览器的很多细节讲得很细，而且也被<a href="http://ux.sohu.com/topics/50972d9ae7de3e752e0081ff" target="_blank" rel="noopener">翻译成了中文</a>。为什么我还想写一篇呢？因为两个原因，</p><p>1）这篇文章太长了，阅读成本太大，不能一口气读完。</p><p>2）花了大力气读了这篇文章后可以了解很多，但似乎对工作没什么帮助。</p><p>所以，我准备写下这篇文章来解决上述两个问题。希望你能在上班途中，或是坐马桶时就能读完，并能从中学会一些能用在工作上的东西。</p><h4 id="浏览器工作大流程"><a href="#浏览器工作大流程" class="headerlink" title="浏览器工作大流程"></a>浏览器工作大流程</h4><p>废话少说，先来看个图：</p><p><img src="http://coolshell.cn//wp-content/uploads/2013/05/Render-Process.jpg" alt=""></p><p>从上面这个图中，我们可以看到那么几个事：</p><p>&nbsp;</p><p>1）浏览器会解析三个东西：</p><ul><li><p>一个是HTML/SVG/XHTML，事实上，Webkit有三个C++的类对应这三类文档。解析这三种文件会产生一个DOM Tree。</p></li><li><p>CSS，解析CSS会产生CSS规则树。</p></li><li><p>Javascript，脚本，主要是通过DOM API和CSSOM API来操作DOM Tree和CSS Rule Tree.<br>2）解析完成后，浏览器引擎会通过DOM Tree 和 CSS Rule Tree 来构造 Rendering Tree。注意：</p></li><li><p>Rendering Tree 渲染树并不等同于DOM树，因为一些像Header或display:none的东西就没必要放在渲染树中了。</p></li><li><p>CSS 的 Rule Tree主要是为了完成匹配并把CSS Rule附加上Rendering Tree上的每个Element。也就是DOM结点。也就是所谓的Frame。</p></li><li><p>然后，计算每个Frame（也就是每个Element）的位置，这又叫layout和reflow过程。<br>3）最后通过调用操作系统Native GUI的API绘制。</p></li></ul><h4 id="DOM解析"><a href="#DOM解析" class="headerlink" title="DOM解析"></a>DOM解析</h4><p>HTML的DOM Tree解析如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Web page parsing<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Web page parsing<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>This is an example Web page.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上面这段HTML会解析成这样：</p><p><img src="http://coolshell.cn//wp-content/uploads/2013/05/DOM-Tree-01.jpg" alt=""></p><p>下面是另一个有SVG标签的情况。</p><p><img src="http://coolshell.cn//wp-content/uploads/2013/05/DOM-Tree-02.jpg" alt=""></p><h4 id="CSS解析"><a href="#CSS解析" class="headerlink" title="CSS解析"></a>CSS解析</h4><p>CSS的解析大概是下面这个样子（下面主要说的是Gecko也就是Firefox的玩法），假设我们有下面的HTML文档：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">doc</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>A few quotes<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">para</span>&gt;</span></span><br><span class="line">  Franklin said that <span class="tag">&lt;<span class="name">quote</span>&gt;</span>"A penny saved is a penny earned."<span class="tag">&lt;/<span class="name">quote</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">para</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">para</span>&gt;</span></span><br><span class="line">  FDR said <span class="tag">&lt;<span class="name">quote</span>&gt;</span>"We have nothing to fear but <span class="tag">&lt;<span class="name">span</span>&gt;</span>fear itself.<span class="tag">&lt;/<span class="name">span</span>&gt;</span>"<span class="tag">&lt;/<span class="name">quote</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">para</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">doc</span>&gt;</span></span><br></pre></td></tr></table></figure><p>于是DOM Tree是这个样子：</p><p><img src="http://coolshell.cn//wp-content/uploads/2013/05/DOM-Tree-Example.jpg" alt=""></p><p>然后我们的CSS文档是这样的：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* rule 1 */</span> <span class="selector-tag">doc</span> &#123; <span class="attribute">display</span>: block; <span class="attribute">text-indent</span>: <span class="number">1em</span>; &#125;</span><br><span class="line"><span class="comment">/* rule 2 */</span> <span class="selector-tag">title</span> &#123; <span class="attribute">display</span>: block; <span class="attribute">font-size</span>: <span class="number">3em</span>; &#125;</span><br><span class="line"><span class="comment">/* rule 3 */</span> <span class="selector-tag">para</span> &#123; <span class="attribute">display</span>: block; &#125;</span><br><span class="line"><span class="comment">/* rule 4 */</span> <span class="selector-attr">[class="emph"]</span> &#123; <span class="attribute">font-style</span>: italic; &#125;</span><br></pre></td></tr></table></figure><p>于是我们的CSS Rule Tree会是这个样子：</p><p><img src="http://coolshell.cn//wp-content/uploads/2013/05/CSS-Rule-Tree-Example.jpg" alt=""></p><p>注意，图中的第4条规则出现了两次，一次是独立的，一次是在规则3的子结点。所以，我们可以知道，建立CSS Rule Tree是需要比照着DOM Tree来的。CSS匹配DOM Tree主要是从右到左解析CSS的Selector，好多人以为这个事会比较快，其实并不一定。关键还看我们的CSS的Selector怎么写了。</p><p><strong>注意：CSS匹配HTML元素是一个相当复杂和有性能问题的事情。所以，你就会在N多地方看到很多人都告诉你，DOM树要小，CSS尽量用id和class，千万不要过渡层叠下去，……</strong></p><p>通过这两个树，我们可以得到一个叫Style Context Tree，也就是下面这样（把CSS Rule结点Attach到DOM Tree上）：</p><p><img src="http://coolshell.cn//wp-content/uploads/2013/05/CSS-Content-Tree-Example.jpg" alt=""></p><p>所以，Firefox基本上来说是通过CSS 解析 生成 CSS Rule Tree，然后，通过比对DOM生成Style Context Tree，然后Firefox通过把Style Context Tree和其Render Tree（Frame Tree）关联上，就完成了。注意：Render Tree会把一些不可见的结点去除掉。而<strong>Firefox中所谓的Frame就是一个DOM结点，不要被其名字所迷惑了</strong>。</p><p><img src="http://coolshell.cn//wp-content/uploads/2013/05/Firefox-style-context-tree.png" alt=""></p><p>注：Webkit不像Firefox要用两个树来干这个，Webkit也有Style对象，它直接把这个Style对象存在了相应的DOM结点上了。</p><h4 id="渲染"><a href="#渲染" class="headerlink" title="渲染"></a>渲染</h4><p>渲染的流程基本上如下（黄色的四个步骤）：</p><ol><li>计算CSS样式</li><li>构建Render Tree</li><li>Layout – 定位坐标和大小，是否换行，各种position, overflow, z-index属性 ……</li><li>正式开画</li></ol><p><img src="http://coolshell.cn//wp-content/uploads/2013/05/Render-Process-Skipping.jpg" alt=""></p><p>注意：上图流程中有很多连接线，这表示了Javascript动态修改了DOM属性或是CSS属会导致重新Layout，有些改变不会，就是那些指到天上的箭头，比如，修改后的CSS rule没有被匹配到，等。</p><p>这里重要要说两个概念，一个是Reflow，另一个是Repaint。这两个不是一回事。</p><p>ul&gt;</p><ul><li>Repaint——屏幕的一部分要重画，比如某个CSS的背景色变了。但是元素的几何尺寸没有变。</li><li>Reflow——意味着元件的几何尺寸变了，我们需要重新验证并计算Render Tree。是Render Tree的一部分或全部发生了变化。这就是Reflow，或是Layout。（<strong>HTML使用的是flow based layout，也就是流式布局，所以，如果某元件的几何尺寸发生了变化，需要重新布局，也就叫reflow</strong>）reflow 会从<html>这个root frame开始递归往下，依次计算所有的结点几何尺寸和位置，在reflow过程中，可能会增加一些frame，比如一个文本字符串必需被包装起来。<br>下面是一个打开Wikipedia时的Layout/reflow的视频（注：HTML在初始化的时候也会做一次reflow，叫 <dfn>intial reflow</dfn>），你可以感受一下：</html></li></ul><p>&nbsp;</p><p><center><object width="480" height="400" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0" align="middle"><param name="src" value="http://player.youku.com/player.php/sid/XMzI5MDg0OTA0/v.swf"><param name="allowfullscreen" value="true"><param name="quality" value="high"><param name="allowscriptaccess" value="always"><embed width="480" height="400" type="application/x-shockwave-flash" src="http://player.youku.com/player.php/sid/XMzI5MDg0OTA0/v.swf" allowfullscreen="true" quality="high" allowscriptaccess="always" align="middle"></object></center>Reflow的成本比Repaint的成本高得多的多。DOM Tree里的每个结点都会有reflow方法，一个结点的reflow很有可能导致子结点，甚至父点以及同级结点的reflow。<strong>在一些高性能的电脑上也许还没什么，但是如果reflow发生在手机上，那么这个过程是非常痛苦和耗电的</strong>。</p><p>&nbsp;</p><p>所以，下面这些动作有很大可能会是成本比较高的。</p><ul><li>当你增加、删除、修改DOM结点时，会导致Reflow或Repaint</li><li>当你移动DOM的位置，或是搞个动画的时候。</li><li>当你修改CSS样式的时候。</li><li>当你Resize窗口的时候（移动端没有这个问题），或是滚动的时候。</li><li>当你修改网页的默认字体时。</li></ul><p>注：display:none会触发reflow，而visibility:hidden只会触发repaint，因为没有发现位置变化。</p><p>多说两句关于滚屏的事，通常来说，如果在滚屏的时候，我们的页面上的所有的像素都会跟着滚动，那么性能上没什么问题，因为我们的显卡对于这种把全屏像素往上往下移的算法是很快。但是如果你有一个fixed的背景图，或是有些Element不跟着滚动，有些Elment是动画，那么这个滚动的动作对于浏览器来说会是相当相当痛苦的一个过程。你可以看到很多这样的网页在滚动的时候性能有多差。因为滚屏也有可能会造成reflow。</p><p>基本上来说，reflow有如下的几个原因：</p><ul><li>Initial。网页初始化的时候。</li><li>Incremental。一些Javascript在操作DOM Tree时。</li><li>Resize。其些元件的尺寸变了。</li><li>StyleChange。如果CSS的属性发生变化了。</li><li>Dirty。几个Incremental的reflow发生在同一个frame的子树上。</li></ul><p>好了，我们来看一个示例吧：</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bstyle = <span class="built_in">document</span>.body.style; <span class="comment">// cache</span></span><br><span class="line"></span><br><span class="line">bstyle.padding = <span class="string">"20px"</span>; <span class="comment">// reflow, repaint</span></span><br><span class="line">bstyle.border = <span class="string">"10px solid red"</span>; <span class="comment">//  再一次的 reflow 和 repaint</span></span><br><span class="line"></span><br><span class="line">bstyle.color = <span class="string">"blue"</span>; <span class="comment">// repaint</span></span><br><span class="line">bstyle.backgroundColor = <span class="string">"#fad"</span>; <span class="comment">// repaint</span></span><br><span class="line"></span><br><span class="line">bstyle.fontSize = <span class="string">"2em"</span>; <span class="comment">// reflow, repaint</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// new DOM element - reflow, repaint</span></span><br><span class="line"><span class="built_in">document</span>.body.appendChild(<span class="built_in">document</span>.createTextNode(<span class="string">'dude!'</span>));</span><br></pre></td></tr></table></figure><p>当然，我们的浏览器是聪明的，它不会像上面那样，你每改一次样式，它就reflow或repaint一次。<strong>一般来说，浏览器会把这样的操作积攒一批，然后做一次reflow，这又叫异步reflow或增量异步reflow</strong>。但是有些情况浏览器是不会这么做的，比如：resize窗口，改变了页面默认的字体，等。对于这些操作，浏览器会马上进行reflow。</p><p>但是有些时候，我们的脚本会阻止浏览器这么干，比如：如果我们请求下面的一些DOM值：</p><ol><li>offsetTop, offsetLeft, offsetWidth, offsetHeight</li><li>scrollTop/Left/Width/Height</li><li>clientTop/Left/Width/Height</li><li>IE中的 getComputedStyle(), 或 currentStyle</li></ol><p>因为，如果我们的程序需要这些值，那么浏览器需要返回最新的值，而这样一样会flush出去一些样式的改变，从而造成频繁的reflow/repaint。</p><h4 id="减少reflow-repaint"><a href="#减少reflow-repaint" class="headerlink" title="减少reflow/repaint"></a>减少reflow/repaint</h4><p>下面是一些Best Practices：</p><p><strong>1）不要一条一条地修改DOM的样式。与其这样，还不如预先定义好css的class，然后修改DOM的className。</strong></p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// bad</span><br><span class="line">var <span class="built_in">left</span> = <span class="number">10</span>,</span><br><span class="line"><span class="built_in">top</span> = <span class="number">10</span>;</span><br><span class="line">el.style.<span class="built_in">left</span> = <span class="built_in">left</span> + <span class="string">"px"</span>;</span><br><span class="line">el.style.<span class="built_in">top</span>  = <span class="built_in">top</span>  + <span class="string">"px"</span>;</span><br><span class="line"></span><br><span class="line">// Good</span><br><span class="line">el.className += <span class="string">" theclassname"</span>;</span><br><span class="line"></span><br><span class="line">// Good</span><br><span class="line">el.style.cssText += <span class="string">"; left: "</span> + <span class="built_in">left</span> + <span class="string">"px; top: "</span> + <span class="built_in">top</span> + <span class="string">"px;"</span>;</span><br></pre></td></tr></table></figure><p><strong>2）把DOM离线后修改。如：</strong></p><ul><li>使用documentFragment 对象在内存里操作DOM</li><li>先把DOM给display:none(有一次reflow)，然后你想怎么改就怎么改。比如修改100次，然后再把他显示出来。</li><li>clone一个DOM结点到内存里，然后想怎么改就怎么改，改完后，和在线的那个的交换一下。<br>3）<strong>不要把DOM结点的属性值放在一个循环里当成循环里的变量。</strong>不然这会导致大量地读写这个结点的属性。</li></ul><p>4）<strong>尽可能的修改层级比较低的DOM</strong>。当然，改变层级比较底的DOM有可能会造成大面积的reflow，但是也可能影响范围很小。</p><p>5）<strong>为动画的HTML元件使用fixed或absoult的position</strong>，那么修改他们的CSS是不会reflow的。</p><p>6）<strong>千万不要使用table布局</strong>。因为可能很小的一个小改动会造成整个table的重新布局。</p><blockquote><p>In this manner, the user agent can begin to lay out the table once the entire first row has been received. Cells in subsequent rows do not affect column widths. Any cell that has content that overflows uses the ‘overflow’ property to determine whether to clip the overflow content.</p><p><cite><a href="http://www.w3.org/TR/CSS21/tables.html#fixed-table-layout" target="_blank" rel="noopener">Fixed layout, CSS 2.1 Specification</a></cite><br>This algorithm may be inefficient since it requires the user agent to have access to all the content in the table before determining the final layout and may demand more than one pass.</p><p><cite><a href="http://www.w3.org/TR/CSS21/tables.html#auto-table-layout" target="_blank" rel="noopener">Automatic layout, CSS 2.1 Specification</a></cite></p></blockquote><h4 id="几个工具和几篇文章"><a href="#几个工具和几篇文章" class="headerlink" title="几个工具和几篇文章"></a>几个工具和几篇文章</h4><p>有时候，你会也许会发现在IE下，你不知道你修改了什么东西，结果CPU一下子就上去了到100%，然后过了好几秒钟repaint/reflow才完成，这种事情以IE的年代时经常发生。所以，我们需要一些工具帮我们看看我们的代码里有没有什么不合适的东西。</p><ul><li><p>Chrome下，Google的<a href="http://code.google.com/webtoolkit/speedtracer/" target="_blank" rel="noopener">SpeedTracer</a>是个非常强悍的工作让你看看你的浏览渲染的成本有多大。其实Safari和Chrome都可以使用开发者工具里的一个Timeline的东东。</p></li><li><p>Firefox下这个基于Firebug的叫<a href="https://addons.mozilla.org/en-US/firefox/addon/firebug-paint-events/" target="_blank" rel="noopener">Firebug Paint Events</a>的插件也不错。</p></li><li><p>IE下你可以用一个叫<a href="http://ajax.dynatrace.com/pages/" target="_blank" rel="noopener">dynaTrace</a>的IE扩展。<br>最后，别忘了下面这几篇提高浏览器性能的文章：</p></li><li><p><a href="http://code.google.com/speed/page-speed/docs/rules_intro.html" target="_blank" rel="noopener">Google – Web Performance Best Practices</a></p></li><li><a href="http://developer.yahoo.com/performance/rules.html" target="_blank" rel="noopener">Yahoo – Best Practices for Speeding Up Your Web Site</a></li><li><a href="http://stevesouders.com/hpws/rules.php" target="_blank" rel="noopener">Steve Souders – 14 Rules for Faster-Loading Web Sites</a></li></ul><h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><ul><li><p>David Baron的演讲：Fast CSS: How Browsers Lay Out Web Pages：<a href="http://dbaron.org/talks/2012-03-11-sxsw/slide-1.xhtml" target="_blank" rel="noopener">slideshow</a>, <a href="http://dbaron.org/talks/2012-03-11-sxsw/master.xhtml" target="_blank" rel="noopener">all slides</a>, <a href="http://audio.sxsw.com/2012/podcasts/11-ACC-Fast_CSS_How_Browser_Layout.mp3" target="_blank" rel="noopener">audio (MP3)</a>, <a href="http://schedule.sxsw.com/2012/events/event_IAP12909" target="_blank" rel="noopener">Session page</a>, <a href="http://lanyrd.com/2012/sxsw-interactive/spmbt/" target="_blank" rel="noopener">Lanyrd page</a></p></li><li><p>How Browsers Work: <a href="http://taligarsiel.com/Projects/howbrowserswork1.htm" target="_blank" rel="noopener">http://taligarsiel.com/Projects/howbrowserswork1.htm</a></p></li><li><p>Mozilla 的 Style System Overview：<a href="https://developer.mozilla.org/en-US/docs/Style_System_Overview" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Style_System_Overview</a></p></li><li><p>Mozilla 的 Note of reflow： <a href="http://www-archive.mozilla.org/newlayout/doc/reflow.html" target="_blank" rel="noopener">http://www-archive.mozilla.org/newlayout/doc/reflow.html</a></p></li><li><p>Rendering: repaint, reflow/relayout, restyle：<a href="http://www.phpied.com/rendering-repaint-reflowrelayout-restyle/" target="_blank" rel="noopener">http://www.phpied.com/rendering-repaint-reflowrelayout-restyle/</a></p></li><li><p>Effective Rendering CSS：<a href="http://css-tricks.com/efficiently-rendering-css/" target="_blank" rel="noopener">http://css-tricks.com/efficiently-rendering-css/</a></p></li><li><p>Webkit Rendering文档：<a href="http://trac.webkit.org/wiki/WebCoreRendering" target="_blank" rel="noopener">http://trac.webkit.org/wiki/WebCoreRendering</a></p></li></ul><p>原文:<a href="http://coolshell.cn/articles/9666.html" target="_blank" rel="noopener">http://coolshell.cn/articles/9666.html</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.love4026.org/313601/浏览器经常崩溃shellext-dll_unloaded/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Ray Chang"><meta itemprop="description" content="Think Difficulty"><meta itemprop="image" content="/logo.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Ray's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/313601/浏览器经常崩溃shellext-dll_unloaded/" itemprop="url">浏览器经常崩溃shellext-dll_unloaded</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2013-06-13T12:22:26+08:00">2013-06-13</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/个人日志/" itemprop="url" rel="index"><span itemprop="name">个人日志</span></a></span></span> <span id="/313601/浏览器经常崩溃shellext-dll_unloaded/" class="leancloud_visitors" data-flag-title="浏览器经常崩溃shellext-dll_unloaded"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数&#58;</span><span class="leancloud-visitors-count"></span></span> <span class="post-meta-divider">|</span><span class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">266</span></span></div></header><div class="post-body" itemprop="articleBody"><p>最近浏览器在保存图片或上传文件时经常崩溃, 个人猜测是因为windows资源管理器的问题, 一直无法解决,今天能过windows的事件查看器,看到以下错误,在网上搜索,果然发现有类似问题, 其实不是浏览器的问题, 以前经常是搜索chrome经常崩溃怎么办, 所以没的到解决办法.</p><p>Application Error</p><p>错误应用程序名称: chrome.exe，版本: 26.0.1410.64，时间戳: 0x5163bfb1<br>错误模块名称: shellext.dll_unloaded，版本: 0.0.0.0，时间戳: 0x50d2bf97<br>异常代码: 0xc0000005<br>错误偏移量: 0x11df83fa<br>错误进程 ID: 0x620<br>错误应用程序启动时间: 0x01ce67dd5bda0094<br>错误应用程序路径: C:\Program Files\Google\Chrome\Application\chrome.exe<br>错误模块路径: shellext.dll<br>报告 ID: 719d9e97-d420-11e2-9e59-50e5494efd95</p><p>问题出在 shellext.dll, 是软件桌面工具,<a href="http://www.wenjian.cn/xijie/shellext.dll.html" target="_blank" rel="noopener">http://www.wenjian.cn/xijie/shellext.dll.html</a> .</p><p>根据这篇文章(<a href="http://blog.csdn.net/phoenix2121/article/details/8854501" target="_blank" rel="noopener">http://blog.csdn.net/phoenix2121/article/details/8854501</a>)确定是快用青苹果助手的问题. 把快用助手卸载掉就行了.</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.love4026.org/313599/privoxy-广告过滤和自动代理切换/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Ray Chang"><meta itemprop="description" content="Think Difficulty"><meta itemprop="image" content="/logo.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Ray's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/313599/privoxy-广告过滤和自动代理切换/" itemprop="url">privoxy 广告过滤和自动代理切换</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2013-06-04T10:24:31+08:00">2013-06-04</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/转载/" itemprop="url" rel="index"><span itemprop="name">转载</span></a></span></span> <span id="/313599/privoxy-广告过滤和自动代理切换/" class="leancloud_visitors" data-flag-title="privoxy 广告过滤和自动代理切换"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数&#58;</span><span class="leancloud-visitors-count"></span></span> <span class="post-meta-divider">|</span><span class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">1,181</span></span></div></header><div class="post-body" itemprop="articleBody"><p>最初用Privoxy是因为七星庐的文章<a href="http://qixinglu.com/archives/powerful_filter_proxy_privoxy" title="http://qixinglu.com/archives/powerful_filter_proxy_privoxy" target="_blank" rel="noopener">强大的代理调度器代理Privoxy</a>，用作代理切换，后来顺便也用起它广告过滤的功能</p><p>能实现这两个功能的软件/插件很多，而且用起来往往比privoxy来的方便，比如foxproxy和adblock。我之所以用privoxy是因为以下原因：</p><ul><li>作为系统的全局自动代理切换器。GNOME和环境变量的代理设置不是对任何软件都管用，PAC也不是哪里都行</li><li>广告过滤可用于任何浏览器，并且容易定制，改改网页什么的</li></ul><p>配置是繁琐些，但用起来确实不错。</p><p>安装用源里的就可以，默认是作为系统服务启动的。装好后请将浏览器代理设置为127.0.0.1:8118，以便测试。地址栏输入”p.p”可以查看配置、文档、调试等等。</p><h2 id="代理切换"><a href="#代理切换" class="headerlink" title="代理切换"></a>代理切换</h2><p>配置文件都在/etc/privoxy目录下。编辑config文件，加入一行<br><code>actionsfile pac.action</code><br>这表示添加一个动作文件，文件名是pac.action。在同目录下建立文件”pac.action”，并写入配置。一个示例如下</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;alias&#125;&#125;</span><br><span class="line">direct      = +forward-override&#123;forward .&#125;</span><br><span class="line">ssh         = +forward-override&#123;forward-socks5 127.0.0.1:7000 .&#125;</span><br><span class="line">gae         = +forward-override&#123;forward 127.0.0.1:8000&#125; </span><br><span class="line">default     = direct</span><br><span class="line"><span class="comment">#==========默认代理==========</span></span><br><span class="line">&#123;default&#125;</span><br><span class="line">/</span><br><span class="line"><span class="comment">#==========直接连接==========</span></span><br><span class="line">&#123;direct&#125; </span><br><span class="line">.edu.cn</span><br><span class="line">202.117.255.</span><br><span class="line">222.24.211.70</span><br><span class="line"><span class="comment">#==========SSH代理==========</span></span><br><span class="line">&#123;ssh&#125;</span><br><span class="line">.launchpad.net</span><br><span class="line"><span class="comment">#==========GAE代理==========</span></span><br><span class="line">&#123;gae&#125;</span><br><span class="line">.webupd8.org</span><br><span class="line">222.24.211.70</span><br></pre></td></tr></table></figure><p>上面的<code></code>部分定义了一些缩写，注意http代理和socks代理的写法不同。</p><p>后面的如{direct}部分定义对哪些地址应用这个代理。其中”/“表示全部地址。注意一个URL的域名部分只能用glob匹配，而地址部分可以用复杂的正则表达式。具体可以看Privoxy的文档</p><p>这些规则在后面的会覆盖前面的，比如<code>222.24.211.70</code>实际是以gae代理访问的。这样可以实现一些稍微复杂的功能</p><h2 id="广告过滤"><a href="#广告过滤" class="headerlink" title="广告过滤"></a>广告过滤</h2><p>广告过滤用的文件要多些，可能还需要filter文件。先看一个最基本的只使用action文件和block动作的广告过滤。直接编辑user.action文件，添加</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;+block&#125;</span><br><span class="line"><span class="string">.5622.cn</span></span><br><span class="line"><span class="string">/.</span>*\<span class="string">.swf</span>$</span><br></pre></td></tr></table></figure><p>这样5622.cn和所有flash都被阻止了。如果你还想看某些flash视频，可以在后面再-block，这会覆盖前面的设置，如</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;-block&#125;</span><br><span class="line">static<span class="selector-class">.youku</span><span class="selector-class">.com</span>/.*\.swf$</span><br></pre></td></tr></table></figure><p>配合filter文件和action文件，可以实现对网页内容的替换，从而屏蔽某些不想要的内容。先编辑config文件，去掉”filterfile user.filter”这行的注释，然后在同目录下建立user.filter文件，写入</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FILTER: iframe</span><br><span class="line">s@<span class="tag">&lt;/<span class="name">head</span>&gt;</span>@<span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined">\n\</span></span><br><span class="line"><span class="undefined">    iframe &#123;display:none; !important&#125;\n\</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span>\n$0@</span><br></pre></td></tr></table></figure><p>这样就定义了一个名为”iframe”的过滤器。之后再编辑user.action文件，添加</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;+<span class="attribute">filter</span>&#123;iframe&#125;&#125;</span><br><span class="line"><span class="selector-class">.filestube</span><span class="selector-class">.com</span></span><br></pre></td></tr></table></figure><p>这表明对filestube应用”iframe”这个过滤器。filter书写复杂些</p><p>除了过滤广告，还能做做地址转向，比如</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;+redirect&#123;s@^<span class="link">http://</span>[<span class="string">^/</span>]<span class="strong">*/.*</span>?&amp;amp;q=(.<span class="strong">*)@http://www.google.com/search?hl=en&amp;amp;q=$1@&#125;&#125;</span></span><br><span class="line"><span class="strong">.google.com.hk/search</span></span><br><span class="line"><span class="strong"></span></span><br><span class="line"><span class="strong">&#123;+redirect&#123;s@^http://[^/]*</span>(/$|$)@http://www.google.com/ncr@&#125;&#125;</span><br><span class="line"><span class="title">.google.com.hk/$</span></span><br></pre></td></tr></table></figure><h2 id="其它内容"><a href="#其它内容" class="headerlink" title="其它内容"></a>其它内容</h2><div></div><h3 id="以普通用户启动"><a href="#以普通用户启动" class="headerlink" title="以普通用户启动"></a>以普通用户启动</h3><p>先关掉privoxy服务，可以用sysv-rc-conf或者直接删掉/etc/init.d/privoxy文件。然后将/etc/privoxy目录的内容复制到家目录下，比如~/.privoxy。编辑config文件，将”confdir /etc/privoxy”改为</p><p><code>confdir /home/用户名/.privoxy</code><br>然后用下面命令启动<br><code>privoxy --no-daemon $HOME/.privoxy/config</code></p><h3 id="有身份验证的代理"><a href="#有身份验证的代理" class="headerlink" title="有身份验证的代理"></a>有身份验证的代理</h3><p>先获得”用户名:密码”的base64编码，方法如下</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">perl</span> -e <span class="string">"use MIME::Base64; print encode_base64('用户名:密码');"</span></span><br></pre></td></tr></table></figure><p>然后这样写alias</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxy = +<span class="keyword">forward</span>-<span class="keyword">override</span><span class="comment">&#123;forward 127.0.0.1:808&#125;</span> +<span class="keyword">add</span>-header<span class="comment">&#123;Proxy-authorization: Basic &lt;auth&gt;&#125;</span></span><br></pre></td></tr></table></figure><p>将<code>&lt;auth&gt;</code>替换为上面得到的base64编码的用户名和密码</p><h2 id="一个完整的方案"><a href="#一个完整的方案" class="headerlink" title="一个完整的方案"></a>一个完整的方案</h2><div><p>上面这些文件完全可以精简和清晰，我的目录下只有config、pac.action、user.action、user.filter这四个文件。另外还可以小脚本来切换默认的代理。下面贴出这些配置和切换脚本，略加修改过的，我的配置目录是~/.proxy</p><ul><li><code>config</code>文件：<a href="http://paste.pocoo.org/show/372744/" title="http://paste.pocoo.org/show/372744/" target="_blank" rel="noopener">http://paste.pocoo.org/show/372744/</a></li><li><code>pac.action</code>文件：<a href="http://paste.pocoo.org/show/372758/" title="http://paste.pocoo.org/show/372758/" target="_blank" rel="noopener">http://paste.pocoo.org/show/372758/</a></li><li><code>user.action</code>文件：<a href="http://paste.pocoo.org/show/372759/" title="http://paste.pocoo.org/show/372759/" target="_blank" rel="noopener">http://paste.pocoo.org/show/372759/</a></li><li><code>user.filter</code>文件：<a href="http://paste.pocoo.org/show/372761/" title="http://paste.pocoo.org/show/372761/" target="_blank" rel="noopener">http://paste.pocoo.org/show/372761/</a><br>上面的<code>pac.action</code>是我在家里用的，学校因为有ipv6等有些不一样：<a href="http://paste.pocoo.org/show/372767/" title="http://paste.pocoo.org/show/372767/" target="_blank" rel="noopener">http://paste.pocoo.org/show/372767/</a></li></ul><p>切换脚本：<a href="http://paste.pocoo.org/show/372771/" title="http://paste.pocoo.org/show/372771/" target="_blank" rel="noopener">http://paste.pocoo.org/show/372771/</a></p><p>这个脚本是，在家里默认代理<code>(default)</code>在<code>direct</code>和<code>gae</code>之间切换，学校是在paper和gae之间切换。绑定个快捷键会很方便</p></div></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.love4026.org/313595/html-5-的自定义-data-属性和jquery的data方法的使用/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Ray Chang"><meta itemprop="description" content="Think Difficulty"><meta itemprop="image" content="/logo.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Ray's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/313595/html-5-的自定义-data-属性和jquery的data方法的使用/" itemprop="url">HTML 5 的自定义 data-* 属性和jquery的data()方法的使用</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2013-05-11T05:34:07+08:00">2013-05-11</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/前端设计/" itemprop="url" rel="index"><span itemprop="name">前端设计</span></a></span></span> <span id="/313595/html-5-的自定义-data-属性和jquery的data方法的使用/" class="leancloud_visitors" data-flag-title="HTML 5 的自定义 data-* 属性和jquery的data()方法的使用"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数&#58;</span><span class="leancloud-visitors-count"></span></span> <span class="post-meta-divider">|</span><span class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">575</span></span></div></header><div class="post-body" itemprop="articleBody"><p>人们总喜欢往HTML标签上添加自定义属性来存储和操作数据。但这样做的问题是，你不知道将来会不会有其它脚本把你的自定义属性给重置掉，此外，你这样做也会导致html语法上不符合Html规范，以及一些其它副作用。这就是为什么在HTML5规范里增加了一个自定义data属性，你可以拿它做很多有用的事情。</p><p>你可以去读一下HTML5的详细规范，但这个自定义data属性的用法非常的简单，就是你可以往HTML标签上添加任意以 “data-“开头的属性，这些属性页面上是不显示的，它不会影响到你的页面布局和风格，但它却是可读可写的。</p><p>下面的一个代码片段是一个有效的HTML5标记：</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">div</span> <span class="built_in">id</span>=<span class="string">"awesome"</span> data-myid=<span class="string">"3e4ae6c4e"</span>&gt;Some awesome data&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure><p>可是，怎么来读取这些数据呢？你当然可以遍历页面元素来读取你想要的属性，但jquery已经内置了方法来操作这些属性。使用jQuery的.data()方法来访问这些”data-*” 属性。其中一个方法就是 .data(obj)，这个方法是在 jQuery1.4.3版本后出现的，它能返回相应的data属性。</p><p>举个例子，你可以用下面的写法读取 data-myid属性值：</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">var</span> myid= jQuery(<span class="string">"#awesome"</span>).<span class="built_in">data</span>(<span class="string">'myid'</span>);</span><br><span class="line">console.<span class="keyword">log</span>(myid);</span><br></pre></td></tr></table></figure><p>你还可以在”data-*” 属性里使用json语法，例如，如果你写出下面的html：</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">div</span> <span class="built_in">id</span>=<span class="string">"awesome-json"</span> data-awesome='&#123;<span class="string">"game"</span>:<span class="string">"on"</span>&#125;'&gt;&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure><p>你可以通过js直接访问这个数据，通过json的key值，你能得到相应的value：</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">var</span> gameStatus= jQuery(<span class="string">"#awesome-json"</span>).<span class="built_in">data</span>(<span class="string">'awesome'</span>).game;</span><br><span class="line">console.<span class="keyword">log</span>(gameStatus);</span><br></pre></td></tr></table></figure><p>你也可以通过.data(key,value)方法直接给”data-<em>“ 属性赋值。一个重要的你要注意的事情是，这些”data-</em>“ 属性应该和它所在的元素有一定的关联，不要把它当成存放任意东西的存储工具。</p><p>译者补充：尽管”data-<em>“ 是HTML5才出现的属性，但jquery是通用的，所以，在非HTML5的页面或浏览器里，你仍然可以使用.data(obj)方法来操作”data-</em>“ 数据。</p><p>[英文原文：<a href="http://blog.mitemitreski.com/2012/06/html-5-data-attributes-how-to-use-it.html" target="_blank" rel="noopener">HTML 5 data-* attributes, how to use them and why</a> ]</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.love4026.org/313590/css伪类与css伪元素的区别及由来/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Ray Chang"><meta itemprop="description" content="Think Difficulty"><meta itemprop="image" content="/logo.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Ray's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/313590/css伪类与css伪元素的区别及由来/" itemprop="url">css伪类与css伪元素的区别及由来</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2013-04-15T06:10:56+08:00">2013-04-15</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/转载/" itemprop="url" rel="index"><span itemprop="name">转载</span></a></span></span> <span id="/313590/css伪类与css伪元素的区别及由来/" class="leancloud_visitors" data-flag-title="css伪类与css伪元素的区别及由来"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数&#58;</span><span class="leancloud-visitors-count"></span></span> <span class="post-meta-divider">|</span><span class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">1,950</span></span></div></header><div class="post-body" itemprop="articleBody"><p>关于两者的区别，其实是很古老的问题。但是时至今日，由于各种网络误传以及一些不负责任的书籍误笔，仍然有相当多的人将伪类与伪元素混为一谈，甚至不乏很多CSS老手。早些年刚入行的时候，我自己也被深深误导，因为论坛里的帖子大多不关心这种概念的细微差别，即使有人出来说一句：“这两个是不同的”，也只是被更多的帖子淹没掉而已。所以觉得有必要写下这些我所知的部分，这里着重写的是<strong>为什么</strong>这两者不同，以及一些平时容易错过的细节。</p><p>无论是<strong>伪类</strong>还是<strong>伪元素</strong>，都属于CSS选择器的范畴。所以它们的定义可以在CSS标准的选择器章节找到。分别是 <a href="http://www.w3.org/TR/CSS2/selector.html" target="_blank" rel="noopener">CSS2.1 Selectors</a> 和 <a href="http://www.w3.org/TR/selectors/" target="_blank" rel="noopener">CSS Selector Level 3</a>，两者都已经是推荐标准。</p><h2 id="标准的定义"><a href="#标准的定义" class="headerlink" title="标准的定义"></a>标准的定义</h2><p>在CSS2.1里，<a href="http://www.w3.org/TR/CSS2/selector.html#pseudo-elements" target="_blank" rel="noopener">5.10 Pseudo-elements and pseudo-classes</a> 描述了这两个概念的由来，它们是被一同提及的。但到了 Selector Level 3 里，它们就被分开到两个小节里加以区分。但无论如何，伪类和伪元素的引入都是因为在文档树里有些信息无法被充分描述，比如CSS没有“段落的第一行”之类的选择器，而这在一些出版场景里又是必须的。用标准里的话说：</p><blockquote><p>CSS introduces the concepts of pseudo-elements and pseudo-classes to permit formatting based on information that lies outside the document tree.<br>简单翻译一下，就是：<br>CSS 引入伪类和伪元素的概念是为了实现基于文档树之外的信息的格式化<br>这么说很抽象，其实就是为了描述一些现有CSS无法描述的东西。缺少什么，则引入什么，不管是标准，还是人，都是如此成长而来。</p></blockquote><h2 id="伪类与伪元素的区别"><a href="#伪类与伪元素的区别" class="headerlink" title="伪类与伪元素的区别"></a>伪类与伪元素的区别</h2><p>这里我大可以列一个表格，把所有的伪类和伪元素分开罗列，但这未免太形式化，与其记住“哪些是哪些不是”，不如真正地加以区分。伪类和伪元素本身就有一个根本的不同之处，这点直接体现在了标准的描述语句上。</p><p>先看一个伪元素 <code>first-line</code> 例子。现在有一段HTML，内容是一个段落：</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;I am <span class="keyword">the</span> bone <span class="keyword">of</span> <span class="keyword">my</span> sword. Steel <span class="keyword">is</span> <span class="keyword">my</span> body, <span class="keyword">and</span> fire <span class="keyword">is</span> <span class="keyword">my</span> blood. </span><br><span class="line">I have created <span class="keyword">over</span> a thoustand blades. </span><br><span class="line">Unknown <span class="keyword">to</span> Death.Nor known <span class="keyword">to</span> Life. Have withstood pain <span class="keyword">to</span> create many weapon. </span><br><span class="line">Yet, those hands will never hold anything. So <span class="keyword">as</span> I pray, unlimited blade works.&lt;/p&gt;</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">如果我要描述这个段落的第一行，在不用伪元素的情况下，我会怎么做？想来我一定要嵌套一层 `span`，然后加上类名:</span><br></pre></td></tr></table></figure><p></p><p><span class="first-line">I am the bone of my sword. Steel is my body, and fire is my blood.</span><br>I have created over a thoustand blades.<br>Unknown to Death.Nor known to Life. Have withstood pain to create many weapon.<br>Yet, those hands will never hold anything. So as I pray, unlimited blade works.</p><br><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">再反观一个伪类 `first-child` 的例子，有一个简单的列表：</span><br></pre></td></tr></table></figure><p></p><p></p><ul><br><li></li><br><li></li><br></ul><br><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">如果我要描述 `ul` 的第一个元素，我无须嵌套新的元素，我只须给第一个已经存在的 `li` 添加一个类名就可以了：</span><br></pre></td></tr></table></figure><p></p><p></p><ul><br><li class="first-child"></li><br><li></li><br></ul><br><code>`</code><p></p><p>尽管，<strong>第一行</strong>和<strong>第一个元素</strong>，这两者的语意相似，但最后作用的效果却完全不同。所以，伪类和伪元素的根本区别在于：<strong>它们是否创造了新的元素(抽象)</strong>。从我们模仿其意义的角度来看，如果需要添加新元素加以标识的，就是伪元素，反之，如果只需要在既有元素上添加类别的，就是伪类。而这也是为什么，标准精确地使用 “create” 一词来解释伪元素，而使用 “classify” 一词来解释伪类的原因。一个描述的是新创建出来的“幽灵”元素，另一个则是描述已经存在的符合“幽灵”类别的元素。</p><p><strong>伪类</strong>一开始单单只是用来表示一些元素的动态状态，典型的就是链接的各个状态(LVHA)。随后CSS2标准扩展了其概念范围，使其成为了所有逻辑上存在但在文档树中却无须标识的“幽灵”分类。</p><p><strong>伪元素</strong>则代表了某个元素的子元素，这个子元素虽然在逻辑上存在，但却并不实际存在于文档树中。</p><h2 id="伪类和伪元素混淆的由来"><a href="#伪类和伪元素混淆的由来" class="headerlink" title="伪类和伪元素混淆的由来"></a>伪类和伪元素混淆的由来</h2><p>最为混淆的，可能是大部分人都将 <code>:before</code> 和 <code>:after</code>这样的伪元素随口叫做伪类，而且即使在概念混淆的情况下，实际使用上也毫无问题——因为即使概念混淆，对真正使用也不会造成多少麻烦:)</p><p>CSS Selector Level 3 为了区分这两者的混淆，而特意用冒号加以区分：</p><ul><li>伪类用一个冒号表示 <code>:first-child</code></li><li>伪元素则使用两个冒号表示 <code>::first-line</code><br>并且规定，浏览器既要兼容CSS1和2里既存的伪元素的单冒号表示，同时又要不兼容CSS3新引入的伪元素的单冒号表示。后来的结果大家都知道，因为低版本IE对双冒号的兼容问题，几乎所有的CSSer在写样式的时候都不约而同的使用了单冒号。这无形中，让这种混淆延续了下来。而CSS3新伪元素的使用到目前为止，还远远不成气候。</li></ul><h2 id="伪类和伪元素使用上需要注意的地方"><a href="#伪类和伪元素使用上需要注意的地方" class="headerlink" title="伪类和伪元素使用上需要注意的地方"></a>伪类和伪元素使用上需要注意的地方</h2><p>明白其不同之后，就需要注意和考虑在实际使用上的一些问题。比如：伪类和伪元素的选择器特殊性(优先级)如何计算？</p><p>我在之前的 <a href="http://www.swordair.com/blog/2012/03/814/" target="_blank" rel="noopener">CSS选择器距离无关</a> 一文中，翻译过CSS标准的计算选择器的特殊性这一部分，看完那部分，答案就清楚了：除了否定伪类的特殊规定外，<strong>分开各自作为真正的类和元素计算</strong>。</p><p>虽然标准以后的版本可能会允许选择器多伪元素的情况，但就目前为止，伪元素在一个选择器里只能出现一次，并且只能出现在末尾。实则，伪元素是选中了某个元素的符合逻辑的某个实际却不存在的部分，所以应用中也不会有人将其误写成多个。伪类则是像真正的类一样发挥着类的作用，没有数量上的限制，只要不是相互排斥的伪类，也可以同时使用在相同的元素上。关于CSS3选择器的详细解释，推荐 rogerjohansson 的 <a href="http://www.456bereastreet.com/archive/200601/css_3_selectors_explained/" target="_blank" rel="noopener">CSS 3 selectors explained</a>。</p><h2 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h2><p>本来只是想稍稍写点，不想话又多了…到了最后，我一度觉得自己还漏了很多，不断在脑海里搜索，但可能只能下次在补充了。写这篇的目的是为下篇《CSS伪类与CSS伪元素的典型应用》做个铺垫，不想理论的东西一写自己就开始废话连篇了，惭愧…回看本篇，自己的思路跳的有些乱了，洋洋洒洒这么多字，可能概括起来没几句话，但如果希望尽可能表达清楚，则又免不了冗余过头。理论总是显得枯燥了些，下篇闲谈应用应该不至于这么沉闷:)</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol><li><a href="http://www.w3.org/TR/CSS2/selector.html#pseudo-elements" target="_blank" rel="noopener">CSS2.1 Pseudo-elements and pseudo-classes</a> from W3C</li><li><a href="http://www.w3.org/TR/selectors/" target="_blank" rel="noopener">Selectors Level 3 W3C Recommendation 29 September 2011</a> from W3C</li><li><a href="http://www.d.umn.edu/~lcarlson/csswork/selectors/pseudo_dif.html" target="_blank" rel="noopener">Difference between a pseudo-class and a pseudo-element</a> by Laura L. Carlson</li><li><a href="http://www.stephanmuller.nl/difference-pseudo-classes-pseudo-elements/" target="_blank" rel="noopener">THE DIFFERENCE BETWEEN PSEUDO-CLASSES AND PSEUDO-ELEMENTS</a> by Stephan Muller</li></ol></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article></section><nav class="pagination"><a class="extend prev" rel="prev" href="/page/14/"><i class="fa fa-angle-left"></i></a> <a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><span class="page-number current">15</span><a class="page-number" href="/page/16/">16</a><span class="space">&hellip;</span><a class="page-number" href="/page/42/">42</a><a class="extend next" rel="next" href="/page/16/"><i class="fa fa-angle-right"></i></a></nav></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><section class="site-overview-wrap sidebar-panel sidebar-panel-active"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/logo.png" alt="Ray Chang"><p class="site-author-name" itemprop="name">Ray Chang</p><p class="site-description motion-element" itemprop="description">Think Difficulty</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">416</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">10</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">242</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/sbmzhcn" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="https://twitter.com/love4026/" target="_blank" title="Twitter"><i class="fa fa-fw fa-twitter"></i> Twitter</a></span><span class="links-of-author-item"><a href="https://plus.google.com/u/0/106618658391372851068" target="_blank" title="Google Plus"><i class="fa fa-fw fa-google"></i> Google Plus</a></span><span class="links-of-author-item"><a href="https://www.facebook.com/love4026" target="_blank" title="Facebook"><i class="fa fa-fw fa-facebook"></i> Facebook</a></span><span class="links-of-author-item"><a href="https://www.v2ex.com/member/sbmzhcn" target="_blank" title="V2EX"><i class="fa fa-fw fa-globe"></i> V2EX</a></span><span class="links-of-author-item"><a href="mailto:love4026@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span></div><div class="cc-license motion-element" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" class="cc-opacity" target="_blank"><img src="/images/cc-by-nc-nd.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="http://www.lanthy.com/" title="蓝悉" target="_blank">蓝悉</a></li><li class="links-of-blogroll-item"> <a href="http://www.shibang-china.com/" title="世邦中文" target="_blank">世邦中文</a></li><li class="links-of-blogroll-item"> <a href="http://www.sbmchina.com/" title="世邦英文" target="_blank">世邦英文</a></li><li class="links-of-blogroll-item"> <a href="http://www.kamychina.com/" title="科煤机电" target="_blank">科煤机电</a></li></ul></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">Copyright &copy; <span itemprop="copyrightYear">2018</span><span class="with-love" id="heart"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Ray Chang. Allrights reserved.</span></div><div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div> <span class="post-meta-divider">|</span><div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4, modified by Ray Chang.</div><div class="leancloud-count"><span id="/" class="leancloud_site_visitors" data-flag-title="Ray's Blog"><i class="fa fa-eye"></i> 本站总访问量<span class="leancloud-visitors-count"></span> 次</span></div><script type="text/javascript">!function(){var e=document.createElement("script");e.src="//tajs.qq.com/stats?sId=65400293";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css"><script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script><script>AV.initialize("ePPAQV9hFzcbhOaQvvtyjTnw-gzGzoHsz","GLniGVXsSMGBjTmaiI4wleaF")</script><script>function showTime(e){var t=new AV.Query(e),c=[],u=$(".leancloud_visitors");u.each(function(){c.push($(this).attr("id").trim())}),t.containedIn("url",c),t.find().done(function(e){var t=".leancloud-visitors-count";if(0!==e.length){for(var n=0;n<e.length;n++){var o=e[n],i=o.get("url"),s=o.get("time"),l=document.getElementById(i);$(l).find(t).text(s)}for(n=0;n<c.length;n++){i=c[n],l=document.getElementById(i);var r=$(l).find(t);""==r.text()&&r.text(0)}}else u.find(t).text(0)}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(i,e){var t=$(e),s=t.attr("id").trim(),l=t.attr("data-flag-title").trim(),n=new AV.Query(i);n.equalTo("url",s),n.find({success:function(e){if(0<e.length){var t=e[0];t.fetchWhenSave(!0),t.increment("time"),t.save(null,{success:function(e){$(document.getElementById(s)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var n=new i,o=new AV.ACL;o.setPublicReadAccess(!0),o.setPublicWriteAccess(!0),n.setACL(o),n.set("title",l),n.set("url",s),n.set("time",1),n.save(null,{success:function(e){$(document.getElementById(s)).find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_site_visitors").length&&addCount(e,".leancloud_site_visitors"),1==$(".leancloud_visitors").length?addCount(e,".leancloud_visitors"):1<$(".post-title-link").length&&showTime(e)})</script></body></html>